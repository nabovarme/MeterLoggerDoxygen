<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MeterLogger: esp-open-lwip/include/lwip/ip.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MeterLogger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_84d76a54d5d264f7baa245697b2fd85c.html">esp-open-lwip</a></li><li class="navelem"><a class="el" href="dir_f216ed0e1c8bb9adcb9945fcb7109cd5.html">include</a></li><li class="navelem"><a class="el" href="dir_97601afe4bcad73cc5507313d013d780.html">lwip</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ip.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="opt_8h_source.html">lwip/opt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="def_8h_source.html">lwip/def.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pbuf_8h_source.html">lwip/pbuf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html">lwip/ip_addr.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="err_8h_source.html">lwip/err.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="netif_8h_source.html">lwip/netif.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ip.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h__incl.svg" width="600" height="948"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h__dep__incl.svg" width="1930" height="306"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="ip_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structip__pcb.html">ip_pcb</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structip__hdr.html">ip_hdr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a516aa115f61c368cbe74fae2da2c6824"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a516aa115f61c368cbe74fae2da2c6824">IP_OPTIONS_SEND</a>&#160;&#160;&#160;<a class="el" href="lwipopts_8h.html#adaf25915ae1fd69c0943ef68cbb38923">LWIP_IGMP</a></td></tr>
<tr class="separator:a516aa115f61c368cbe74fae2da2c6824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad76777d4d34f33ab5f715f9ca15503c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#ad76777d4d34f33ab5f715f9ca15503c3">IP_HLEN</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:ad76777d4d34f33ab5f715f9ca15503c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacaea7b8c4c8a5229c02b653766b4793"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#aacaea7b8c4c8a5229c02b653766b4793">IP_PROTO_ICMP</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aacaea7b8c4c8a5229c02b653766b4793"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f8609139fce15ace0c6d117021e29a4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a4f8609139fce15ace0c6d117021e29a4">IP_PROTO_IGMP</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a4f8609139fce15ace0c6d117021e29a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76212e7ef71a99646040d2e454388bed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a76212e7ef71a99646040d2e454388bed">IP_PROTO_UDP</a>&#160;&#160;&#160;17</td></tr>
<tr class="separator:a76212e7ef71a99646040d2e454388bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ef2b8a1cb4f7acee3142337438dfd0d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a3ef2b8a1cb4f7acee3142337438dfd0d">IP_PROTO_UDPLITE</a>&#160;&#160;&#160;136</td></tr>
<tr class="separator:a3ef2b8a1cb4f7acee3142337438dfd0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a634284ee3a136d6ad61bc5d917ebb82f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a634284ee3a136d6ad61bc5d917ebb82f">IP_PROTO_TCP</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a634284ee3a136d6ad61bc5d917ebb82f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4294940df109ad673a7295b74259b0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a4c4294940df109ad673a7295b74259b0">IP_HDRINCL</a>&#160;&#160;&#160;<a class="el" href="c__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td></tr>
<tr class="separator:a4c4294940df109ad673a7295b74259b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a7497f9c87e25b66382e1b92f56382"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a19a7497f9c87e25b66382e1b92f56382">IP_PCB_ADDRHINT</a></td></tr>
<tr class="separator:a19a7497f9c87e25b66382e1b92f56382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bdf4b5f674375e76cdd968826d80e53"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a8bdf4b5f674375e76cdd968826d80e53">IP_PCB</a></td></tr>
<tr class="separator:a8bdf4b5f674375e76cdd968826d80e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4cefea756e815021a13dc0ca60e4ea4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#ac4cefea756e815021a13dc0ca60e4ea4">SOF_ACCEPTCONN</a>&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x02U  /* socket has had listen() */</td></tr>
<tr class="separator:ac4cefea756e815021a13dc0ca60e4ea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa40b3366a7939ec3a60e9a7d239575e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#aa40b3366a7939ec3a60e9a7d239575e2">SOF_REUSEADDR</a>&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x04U  /* allow local address reuse */</td></tr>
<tr class="separator:aa40b3366a7939ec3a60e9a7d239575e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f7f7efb095c77c06af5c5e8ba558d45"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a1f7f7efb095c77c06af5c5e8ba558d45">SOF_KEEPALIVE</a>&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x08U  /* keep connections alive */</td></tr>
<tr class="separator:a1f7f7efb095c77c06af5c5e8ba558d45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c7ccdad2d7d3a264bd8cfc57140ca8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#ac8c7ccdad2d7d3a264bd8cfc57140ca8">SOF_BROADCAST</a>&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x20U  /* permit to send and to receive broadcast messages (see IP_SOF_BROADCAST option) */</td></tr>
<tr class="separator:ac8c7ccdad2d7d3a264bd8cfc57140ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6074d7133ead09d96107a862f18309a4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a6074d7133ead09d96107a862f18309a4">SOF_LINGER</a>&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x80U  /* linger on close if data present */</td></tr>
<tr class="separator:a6074d7133ead09d96107a862f18309a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4bbdf8a2e757d758ec0e1c91b58893f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#ae4bbdf8a2e757d758ec0e1c91b58893f">SOF_INHERITED</a>&#160;&#160;&#160;(<a class="el" href="ip_8h.html#aa40b3366a7939ec3a60e9a7d239575e2">SOF_REUSEADDR</a>|<a class="el" href="ip_8h.html#a1f7f7efb095c77c06af5c5e8ba558d45">SOF_KEEPALIVE</a>|<a class="el" href="ip_8h.html#a6074d7133ead09d96107a862f18309a4">SOF_LINGER</a>/*|SOF_DEBUG|SOF_DONTROUTE|SOF_OOBINLINE*/)</td></tr>
<tr class="separator:ae4bbdf8a2e757d758ec0e1c91b58893f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a895709708f8f909cf7b7459491d549e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a895709708f8f909cf7b7459491d549e7">IP_RF</a>&#160;&#160;&#160;0x8000        /* reserved fragment flag */</td></tr>
<tr class="separator:a895709708f8f909cf7b7459491d549e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2473f4a88d141d5298f92a4335b714a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#ae2473f4a88d141d5298f92a4335b714a">IP_DF</a>&#160;&#160;&#160;0x4000        /* dont fragment flag */</td></tr>
<tr class="separator:ae2473f4a88d141d5298f92a4335b714a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8afe1e04bb9bad791443556c3b2cd73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#ae8afe1e04bb9bad791443556c3b2cd73">IP_MF</a>&#160;&#160;&#160;0x2000        /* more fragments flag */</td></tr>
<tr class="separator:ae8afe1e04bb9bad791443556c3b2cd73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad059798b16d1f615b5af8770175121ba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#ad059798b16d1f615b5af8770175121ba">IP_OFFMASK</a>&#160;&#160;&#160;0x1fff   /* mask for fragmenting bits */</td></tr>
<tr class="separator:ad059798b16d1f615b5af8770175121ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a9e8ecf4eff38244b4c13c7e70094c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a05a9e8ecf4eff38244b4c13c7e70094c">IPH_V</a>(hdr)&#160;&#160;&#160;(<a class="el" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>((hdr)-&gt;_v_hl_tos) &gt;&gt; 12)</td></tr>
<tr class="separator:a05a9e8ecf4eff38244b4c13c7e70094c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c60caeb708571a07a44309c10ec3a01"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a7c60caeb708571a07a44309c10ec3a01">IPH_HL</a>(hdr)&#160;&#160;&#160;((<a class="el" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>((hdr)-&gt;_v_hl_tos) &gt;&gt; 8) &amp; 0x0f)</td></tr>
<tr class="separator:a7c60caeb708571a07a44309c10ec3a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13fb5476ab97db9c5de6c1f5ca0d82e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a13fb5476ab97db9c5de6c1f5ca0d82e6">IPH_TOS</a>(hdr)&#160;&#160;&#160;(<a class="el" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>((hdr)-&gt;_v_hl_tos) &amp; 0xff)</td></tr>
<tr class="separator:a13fb5476ab97db9c5de6c1f5ca0d82e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec0328fe4711b8c1ef4dd6709e4fd6d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#aec0328fe4711b8c1ef4dd6709e4fd6d5">IPH_LEN</a>(hdr)&#160;&#160;&#160;((hdr)-&gt;_len)</td></tr>
<tr class="separator:aec0328fe4711b8c1ef4dd6709e4fd6d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae79eaecc0bf9e4dbb9e47ea56ad2157a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#ae79eaecc0bf9e4dbb9e47ea56ad2157a">IPH_ID</a>(hdr)&#160;&#160;&#160;((hdr)-&gt;_id)</td></tr>
<tr class="separator:ae79eaecc0bf9e4dbb9e47ea56ad2157a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559dce3878f1d6a46bcb4cb312962397"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a559dce3878f1d6a46bcb4cb312962397">IPH_OFFSET</a>(hdr)&#160;&#160;&#160;((hdr)-&gt;_offset)</td></tr>
<tr class="separator:a559dce3878f1d6a46bcb4cb312962397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d8238411ce35a007170f652e62209b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a0d8238411ce35a007170f652e62209b3">IPH_TTL</a>(hdr)&#160;&#160;&#160;((hdr)-&gt;_ttl)</td></tr>
<tr class="separator:a0d8238411ce35a007170f652e62209b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2de6f9d35337b4be67d799805665e11"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#aa2de6f9d35337b4be67d799805665e11">IPH_PROTO</a>(hdr)&#160;&#160;&#160;((hdr)-&gt;_proto)</td></tr>
<tr class="separator:aa2de6f9d35337b4be67d799805665e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a773b96f54c75b35bcd24e7f857fcf988"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a773b96f54c75b35bcd24e7f857fcf988">IPH_CHKSUM</a>(hdr)&#160;&#160;&#160;((hdr)-&gt;_chksum)</td></tr>
<tr class="separator:a773b96f54c75b35bcd24e7f857fcf988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65a5ff431603908b698b69ff5151f888"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a65a5ff431603908b698b69ff5151f888">IPH_VHLTOS_SET</a>(hdr,  v,  hl,  tos)&#160;&#160;&#160;(hdr)-&gt;_v_hl_tos = (<a class="el" href="def_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(((v) &lt;&lt; 12) | ((hl) &lt;&lt; 8) | (tos)))</td></tr>
<tr class="separator:a65a5ff431603908b698b69ff5151f888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a069cb9b3765c4bdd63d13efb2df0206e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a069cb9b3765c4bdd63d13efb2df0206e">IPH_LEN_SET</a>(hdr,  len)&#160;&#160;&#160;(hdr)-&gt;_len = (len)</td></tr>
<tr class="separator:a069cb9b3765c4bdd63d13efb2df0206e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b2c57b6a9dc9cc32fc2f145a96bbf8f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a3b2c57b6a9dc9cc32fc2f145a96bbf8f">IPH_ID_SET</a>(hdr,  id)&#160;&#160;&#160;(hdr)-&gt;_id = (id)</td></tr>
<tr class="separator:a3b2c57b6a9dc9cc32fc2f145a96bbf8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c2189e1400dca1c0f785de96ceda2b6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a4c2189e1400dca1c0f785de96ceda2b6">IPH_OFFSET_SET</a>(hdr,  off)&#160;&#160;&#160;(hdr)-&gt;_offset = (off)</td></tr>
<tr class="separator:a4c2189e1400dca1c0f785de96ceda2b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e49f03bd4c3144e3548a0db72d1deb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#aa0e49f03bd4c3144e3548a0db72d1deb">IPH_TTL_SET</a>(hdr,  ttl)&#160;&#160;&#160;(hdr)-&gt;_ttl = (<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)(ttl)</td></tr>
<tr class="separator:aa0e49f03bd4c3144e3548a0db72d1deb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49753f7668f741b1877340bff6fb97c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a49753f7668f741b1877340bff6fb97c3">IPH_PROTO_SET</a>(hdr,  proto)&#160;&#160;&#160;(hdr)-&gt;_proto = (<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)(proto)</td></tr>
<tr class="separator:a49753f7668f741b1877340bff6fb97c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec30403fb98b013bd094688de55cdaef"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#aec30403fb98b013bd094688de55cdaef">IPH_CHKSUM_SET</a>(hdr,  chksum)&#160;&#160;&#160;(hdr)-&gt;_chksum = (chksum)</td></tr>
<tr class="separator:aec30403fb98b013bd094688de55cdaef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8f76e63a5ac453ba18ca2e1ad6f547"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#adc8f76e63a5ac453ba18ca2e1ad6f547">ip_init</a>()&#160;&#160;&#160;/* Compatibility define, not init needed. */</td></tr>
<tr class="separator:adc8f76e63a5ac453ba18ca2e1ad6f547"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabecef3c7653a9767c79245c44fcab9f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#aabecef3c7653a9767c79245c44fcab9f">ip_current_netif</a>()&#160;&#160;&#160;(<a class="el" href="ip_8c.html#aabce496c19c6ae4000174c8af8a4a913">current_netif</a>)</td></tr>
<tr class="separator:aabecef3c7653a9767c79245c44fcab9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea556557a5fd5322cc2ba6eca5b2c068"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#aea556557a5fd5322cc2ba6eca5b2c068">ip_current_header</a>()&#160;&#160;&#160;(<a class="el" href="ip_8c.html#a169cfb7f1ed23bc514e3e567644291af">current_header</a>)</td></tr>
<tr class="separator:aea556557a5fd5322cc2ba6eca5b2c068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e35b7692c228c98e738892f0a215647"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a4e35b7692c228c98e738892f0a215647">ip_current_src_addr</a>()&#160;&#160;&#160;(&amp;<a class="el" href="ip_8c.html#a312380e254b06dd3041065a3ec27264b">current_iphdr_src</a>)</td></tr>
<tr class="separator:a4e35b7692c228c98e738892f0a215647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9135977868017c3deeec86b525e13997"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a9135977868017c3deeec86b525e13997">ip_current_dest_addr</a>()&#160;&#160;&#160;(&amp;<a class="el" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>)</td></tr>
<tr class="separator:a9135977868017c3deeec86b525e13997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86a6ffcb10aab6f5a02c9b7d8e516f0a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a86a6ffcb10aab6f5a02c9b7d8e516f0a">ip_debug_print</a>(p)</td></tr>
<tr class="separator:a86a6ffcb10aab6f5a02c9b7d8e516f0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8af345b23f3bbec11f8d3eb55671cf7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#ac8af345b23f3bbec11f8d3eb55671cf7">napt_debug_print</a>(p)</td></tr>
<tr class="separator:ac8af345b23f3bbec11f8d3eb55671cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a134eb96f764190bd45f97284d1bf3c4f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structnetif.html">netif</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a134eb96f764190bd45f97284d1bf3c4f">ip_route</a> (<a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *dest) <a class="el" href="c__types_8h.html#afebd45c0d36db732504450393777ce5c">ICACHE_FLASH_ATTR</a></td></tr>
<tr class="separator:a134eb96f764190bd45f97284d1bf3c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a195d1813b8e5468028079f9518973c19"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structnetif.html">netif</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a195d1813b8e5468028079f9518973c19">ip_router</a> (<a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *dest, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *source)</td></tr>
<tr class="separator:a195d1813b8e5468028079f9518973c19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9feb530a8af39f237202b679b5be04a1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="err_8h.html#af02d9da80fd66b4f986d2c53d7231ddb">err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a9feb530a8af39f237202b679b5be04a1">ip_input</a> (struct <a class="el" href="structpbuf.html">pbuf</a> *p, struct <a class="el" href="structnetif.html">netif</a> *inp) <a class="el" href="c__types_8h.html#afebd45c0d36db732504450393777ce5c">ICACHE_FLASH_ATTR</a></td></tr>
<tr class="separator:a9feb530a8af39f237202b679b5be04a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a832a0012dc03b2b9428ca9cfb36e5182"><td class="memItemLeft" align="right" valign="top"><a class="el" href="err_8h.html#af02d9da80fd66b4f986d2c53d7231ddb">err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a832a0012dc03b2b9428ca9cfb36e5182">ip_output</a> (struct <a class="el" href="structpbuf.html">pbuf</a> *p, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *src, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *dest, <a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> ttl, <a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> tos, <a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> proto) <a class="el" href="c__types_8h.html#afebd45c0d36db732504450393777ce5c">ICACHE_FLASH_ATTR</a></td></tr>
<tr class="separator:a832a0012dc03b2b9428ca9cfb36e5182"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e401f7437b993011d343f78f6647a76"><td class="memItemLeft" align="right" valign="top"><a class="el" href="err_8h.html#af02d9da80fd66b4f986d2c53d7231ddb">err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a0e401f7437b993011d343f78f6647a76">ip_output_if</a> (struct <a class="el" href="structpbuf.html">pbuf</a> *p, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *src, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *dest, <a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> ttl, <a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> tos, <a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> proto, struct <a class="el" href="structnetif.html">netif</a> *<a class="el" href="structnetif.html">netif</a>) <a class="el" href="c__types_8h.html#afebd45c0d36db732504450393777ce5c">ICACHE_FLASH_ATTR</a></td></tr>
<tr class="separator:a0e401f7437b993011d343f78f6647a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7082e3ecbecbf496df63fda29a1e0f06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="arch_8h.html#a73199061891adf1b912d20835c7d5e96">PACK_STRUCT_BEGIN</a> struct <a class="el" href="structip__hdr.html">ip_hdr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a7082e3ecbecbf496df63fda29a1e0f06">PACK_STRUCT_STRUCT</a></td></tr>
<tr class="separator:a7082e3ecbecbf496df63fda29a1e0f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabce496c19c6ae4000174c8af8a4a913"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structnetif.html">netif</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#aabce496c19c6ae4000174c8af8a4a913">current_netif</a></td></tr>
<tr class="separator:aabce496c19c6ae4000174c8af8a4a913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a169cfb7f1ed23bc514e3e567644291af"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="structip__hdr.html">ip_hdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a169cfb7f1ed23bc514e3e567644291af">current_header</a></td></tr>
<tr class="separator:a169cfb7f1ed23bc514e3e567644291af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a312380e254b06dd3041065a3ec27264b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a312380e254b06dd3041065a3ec27264b">current_iphdr_src</a></td></tr>
<tr class="separator:a312380e254b06dd3041065a3ec27264b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63c0914cf407e33af9b47061bd6ae40d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ip_8h.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a></td></tr>
<tr class="separator:a63c0914cf407e33af9b47061bd6ae40d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a9135977868017c3deeec86b525e13997"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9135977868017c3deeec86b525e13997">&#9670;&nbsp;</a></span>ip_current_dest_addr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ip_current_dest_addr</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(&amp;<a class="el" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destination IP address of current_header </p>

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00201">201</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="aea556557a5fd5322cc2ba6eca5b2c068"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea556557a5fd5322cc2ba6eca5b2c068">&#9670;&nbsp;</a></span>ip_current_header</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ip_current_header</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="ip_8c.html#a169cfb7f1ed23bc514e3e567644291af">current_header</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the IP header of the current packet. This function must only be called from a receive callback (udp_recv, raw_recv, tcp_accept). It will return NULL otherwise. </p>

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00197">197</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="aabecef3c7653a9767c79245c44fcab9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabecef3c7653a9767c79245c44fcab9f">&#9670;&nbsp;</a></span>ip_current_netif</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ip_current_netif</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="ip_8c.html#aabce496c19c6ae4000174c8af8a4a913">current_netif</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the interface that received the current packet. This function must only be called from a receive callback (udp_recv, raw_recv, tcp_accept). It will return NULL otherwise. </p>

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00193">193</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="a4e35b7692c228c98e738892f0a215647"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e35b7692c228c98e738892f0a215647">&#9670;&nbsp;</a></span>ip_current_src_addr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ip_current_src_addr</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(&amp;<a class="el" href="ip_8c.html#a312380e254b06dd3041065a3ec27264b">current_iphdr_src</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Source IP address of current_header </p>

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00199">199</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="a86a6ffcb10aab6f5a02c9b7d8e516f0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86a6ffcb10aab6f5a02c9b7d8e516f0a">&#9670;&nbsp;</a></span>ip_debug_print</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ip_debug_print</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00206">206</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>, and <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>.</p>

</div>
</div>
<a id="ae2473f4a88d141d5298f92a4335b714a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2473f4a88d141d5298f92a4335b714a">&#9670;&nbsp;</a></span>IP_DF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_DF&#160;&#160;&#160;0x4000        /* dont fragment flag */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00126">126</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="a4c4294940df109ad673a7295b74259b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c4294940df109ad673a7295b74259b0">&#9670;&nbsp;</a></span>IP_HDRINCL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_HDRINCL&#160;&#160;&#160;<a class="el" href="c__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00064">64</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>.</p>

</div>
</div>
<a id="ad76777d4d34f33ab5f715f9ca15503c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad76777d4d34f33ab5f715f9ca15503c3">&#9670;&nbsp;</a></span>IP_HLEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_HLEN&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00050">50</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>, and <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>.</p>

</div>
</div>
<a id="adc8f76e63a5ac453ba18ca2e1ad6f547"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8f76e63a5ac453ba18ca2e1ad6f547">&#9670;&nbsp;</a></span>ip_init</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ip_init</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;/* Compatibility define, not init needed. */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00171">171</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l00261">lwip_init()</a>.</p>

</div>
</div>
<a id="ae8afe1e04bb9bad791443556c3b2cd73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8afe1e04bb9bad791443556c3b2cd73">&#9670;&nbsp;</a></span>IP_MF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_MF&#160;&#160;&#160;0x2000        /* more fragments flag */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00127">127</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>.</p>

</div>
</div>
<a id="ad059798b16d1f615b5af8770175121ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad059798b16d1f615b5af8770175121ba">&#9670;&nbsp;</a></span>IP_OFFMASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_OFFMASK&#160;&#160;&#160;0x1fff   /* mask for fragmenting bits */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00128">128</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, and <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>.</p>

</div>
</div>
<a id="a516aa115f61c368cbe74fae2da2c6824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a516aa115f61c368cbe74fae2da2c6824">&#9670;&nbsp;</a></span>IP_OPTIONS_SEND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_OPTIONS_SEND&#160;&#160;&#160;<a class="el" href="lwipopts_8h.html#adaf25915ae1fd69c0943ef68cbb38923">LWIP_IGMP</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Currently, the function ip_output_if_opt() is only used with IGMP </p>

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00048">48</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="a8bdf4b5f674375e76cdd968826d80e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bdf4b5f674375e76cdd968826d80e53">&#9670;&nbsp;</a></span>IP_PCB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_PCB</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="comment">/* ip addresses in network byte order */</span> \</div><div class="line">  ip_addr_t local_ip; \</div><div class="line">  ip_addr_t remote_ip; \</div><div class="line">   <span class="comment">/* Socket options */</span>  \</div><div class="line">  u8_t so_options;      \</div><div class="line">   <span class="comment">/* Type Of Service */</span> \</div><div class="line">  u8_t tos;              \</div><div class="line">  <span class="comment">/* Time To Live */</span>     \</div><div class="line">  u8_t ttl               \</div><div class="line">  <span class="comment">/* link layer address resolution hint */</span> \</div><div class="line">  IP_PCB_ADDRHINT</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00076">76</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="a19a7497f9c87e25b66382e1b92f56382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a7497f9c87e25b66382e1b92f56382">&#9670;&nbsp;</a></span>IP_PCB_ADDRHINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_PCB_ADDRHINT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00069">69</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="aacaea7b8c4c8a5229c02b653766b4793"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacaea7b8c4c8a5229c02b653766b4793">&#9670;&nbsp;</a></span>IP_PROTO_ICMP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_PROTO_ICMP&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00052">52</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="wifi_8c_source.html#l00102">acl_check_packet()</a>, <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="a4f8609139fce15ace0c6d117021e29a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f8609139fce15ace0c6d117021e29a4">&#9670;&nbsp;</a></span>IP_PROTO_IGMP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_PROTO_IGMP&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00053">53</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>.</p>

</div>
</div>
<a id="a634284ee3a136d6ad61bc5d917ebb82f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a634284ee3a136d6ad61bc5d917ebb82f">&#9670;&nbsp;</a></span>IP_PROTO_TCP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_PROTO_TCP&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00056">56</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="wifi_8c_source.html#l00102">acl_check_packet()</a>, <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="a76212e7ef71a99646040d2e454388bed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76212e7ef71a99646040d2e454388bed">&#9670;&nbsp;</a></span>IP_PROTO_UDP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_PROTO_UDP&#160;&#160;&#160;17</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00054">54</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="wifi_8c_source.html#l00102">acl_check_packet()</a>, <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="a3ef2b8a1cb4f7acee3142337438dfd0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ef2b8a1cb4f7acee3142337438dfd0d">&#9670;&nbsp;</a></span>IP_PROTO_UDPLITE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_PROTO_UDPLITE&#160;&#160;&#160;136</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00055">55</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>.</p>

</div>
</div>
<a id="a895709708f8f909cf7b7459491d549e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a895709708f8f909cf7b7459491d549e7">&#9670;&nbsp;</a></span>IP_RF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IP_RF&#160;&#160;&#160;0x8000        /* reserved fragment flag */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00125">125</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="a773b96f54c75b35bcd24e7f857fcf988"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a773b96f54c75b35bcd24e7f857fcf988">&#9670;&nbsp;</a></span>IPH_CHKSUM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_CHKSUM</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr</td><td>)</td>
          <td>&#160;&#160;&#160;((hdr)-&gt;_chksum)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00152">152</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="aec30403fb98b013bd094688de55cdaef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec30403fb98b013bd094688de55cdaef">&#9670;&nbsp;</a></span>IPH_CHKSUM_SET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_CHKSUM_SET</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">chksum&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(hdr)-&gt;_chksum = (chksum)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00160">160</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="a7c60caeb708571a07a44309c10ec3a01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c60caeb708571a07a44309c10ec3a01">&#9670;&nbsp;</a></span>IPH_HL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_HL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr</td><td>)</td>
          <td>&#160;&#160;&#160;((<a class="el" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>((hdr)-&gt;_v_hl_tos) &gt;&gt; 8) &amp; 0x0f)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00145">145</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="ae79eaecc0bf9e4dbb9e47ea56ad2157a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae79eaecc0bf9e4dbb9e47ea56ad2157a">&#9670;&nbsp;</a></span>IPH_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_ID</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr</td><td>)</td>
          <td>&#160;&#160;&#160;((hdr)-&gt;_id)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00148">148</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, and <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>.</p>

</div>
</div>
<a id="a3b2c57b6a9dc9cc32fc2f145a96bbf8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b2c57b6a9dc9cc32fc2f145a96bbf8f">&#9670;&nbsp;</a></span>IPH_ID_SET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_ID_SET</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">id&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(hdr)-&gt;_id = (id)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00156">156</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>.</p>

</div>
</div>
<a id="aec0328fe4711b8c1ef4dd6709e4fd6d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec0328fe4711b8c1ef4dd6709e4fd6d5">&#9670;&nbsp;</a></span>IPH_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_LEN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr</td><td>)</td>
          <td>&#160;&#160;&#160;((hdr)-&gt;_len)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00147">147</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, and <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>.</p>

</div>
</div>
<a id="a069cb9b3765c4bdd63d13efb2df0206e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a069cb9b3765c4bdd63d13efb2df0206e">&#9670;&nbsp;</a></span>IPH_LEN_SET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_LEN_SET</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">len&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(hdr)-&gt;_len = (len)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00155">155</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>.</p>

</div>
</div>
<a id="a559dce3878f1d6a46bcb4cb312962397"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a559dce3878f1d6a46bcb4cb312962397">&#9670;&nbsp;</a></span>IPH_OFFSET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_OFFSET</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr</td><td>)</td>
          <td>&#160;&#160;&#160;((hdr)-&gt;_offset)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00149">149</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, and <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>.</p>

</div>
</div>
<a id="a4c2189e1400dca1c0f785de96ceda2b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c2189e1400dca1c0f785de96ceda2b6">&#9670;&nbsp;</a></span>IPH_OFFSET_SET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_OFFSET_SET</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">off&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(hdr)-&gt;_offset = (off)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00157">157</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>.</p>

</div>
</div>
<a id="aa2de6f9d35337b4be67d799805665e11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2de6f9d35337b4be67d799805665e11">&#9670;&nbsp;</a></span>IPH_PROTO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_PROTO</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr</td><td>)</td>
          <td>&#160;&#160;&#160;((hdr)-&gt;_proto)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00151">151</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="wifi_8c_source.html#l00102">acl_check_packet()</a>, <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="a49753f7668f741b1877340bff6fb97c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49753f7668f741b1877340bff6fb97c3">&#9670;&nbsp;</a></span>IPH_PROTO_SET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_PROTO_SET</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">proto&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(hdr)-&gt;_proto = (<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)(proto)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00159">159</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>.</p>

</div>
</div>
<a id="a13fb5476ab97db9c5de6c1f5ca0d82e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13fb5476ab97db9c5de6c1f5ca0d82e6">&#9670;&nbsp;</a></span>IPH_TOS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_TOS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>((hdr)-&gt;_v_hl_tos) &amp; 0xff)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00146">146</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>.</p>

</div>
</div>
<a id="a0d8238411ce35a007170f652e62209b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d8238411ce35a007170f652e62209b3">&#9670;&nbsp;</a></span>IPH_TTL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_TTL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr</td><td>)</td>
          <td>&#160;&#160;&#160;((hdr)-&gt;_ttl)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00150">150</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="aa0e49f03bd4c3144e3548a0db72d1deb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e49f03bd4c3144e3548a0db72d1deb">&#9670;&nbsp;</a></span>IPH_TTL_SET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_TTL_SET</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ttl&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(hdr)-&gt;_ttl = (<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)(ttl)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00158">158</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="a05a9e8ecf4eff38244b4c13c7e70094c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05a9e8ecf4eff38244b4c13c7e70094c">&#9670;&nbsp;</a></span>IPH_V</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_V</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>((hdr)-&gt;_v_hl_tos) &gt;&gt; 12)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00144">144</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, and <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>.</p>

</div>
</div>
<a id="a65a5ff431603908b698b69ff5151f888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65a5ff431603908b698b69ff5151f888">&#9670;&nbsp;</a></span>IPH_VHLTOS_SET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IPH_VHLTOS_SET</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hdr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">v, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hl, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tos&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(hdr)-&gt;_v_hl_tos = (<a class="el" href="def_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(((v) &lt;&lt; 12) | ((hl) &lt;&lt; 8) | (tos)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00154">154</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>.</p>

</div>
</div>
<a id="ac8af345b23f3bbec11f8d3eb55671cf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8af345b23f3bbec11f8d3eb55671cf7">&#9670;&nbsp;</a></span>napt_debug_print</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define napt_debug_print</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00212">212</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="ac4cefea756e815021a13dc0ca60e4ea4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4cefea756e815021a13dc0ca60e4ea4">&#9670;&nbsp;</a></span>SOF_ACCEPTCONN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOF_ACCEPTCONN&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x02U  /* socket has had listen() */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00098">98</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="ac8c7ccdad2d7d3a264bd8cfc57140ca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8c7ccdad2d7d3a264bd8cfc57140ca8">&#9670;&nbsp;</a></span>SOF_BROADCAST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOF_BROADCAST&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x20U  /* permit to send and to receive broadcast messages (see IP_SOF_BROADCAST option) */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00102">102</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="ae4bbdf8a2e757d758ec0e1c91b58893f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4bbdf8a2e757d758ec0e1c91b58893f">&#9670;&nbsp;</a></span>SOF_INHERITED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOF_INHERITED&#160;&#160;&#160;(<a class="el" href="ip_8h.html#aa40b3366a7939ec3a60e9a7d239575e2">SOF_REUSEADDR</a>|<a class="el" href="ip_8h.html#a1f7f7efb095c77c06af5c5e8ba558d45">SOF_KEEPALIVE</a>|<a class="el" href="ip_8h.html#a6074d7133ead09d96107a862f18309a4">SOF_LINGER</a>/*|SOF_DEBUG|SOF_DONTROUTE|SOF_OOBINLINE*/)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00109">109</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="a1f7f7efb095c77c06af5c5e8ba558d45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f7f7efb095c77c06af5c5e8ba558d45">&#9670;&nbsp;</a></span>SOF_KEEPALIVE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOF_KEEPALIVE&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x08U  /* keep connections alive */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00100">100</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="a6074d7133ead09d96107a862f18309a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6074d7133ead09d96107a862f18309a4">&#9670;&nbsp;</a></span>SOF_LINGER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOF_LINGER&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x80U  /* linger on close if data present */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00104">104</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<a id="aa40b3366a7939ec3a60e9a7d239575e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa40b3366a7939ec3a60e9a7d239575e2">&#9670;&nbsp;</a></span>SOF_REUSEADDR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOF_REUSEADDR&#160;&#160;&#160;(<a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>)0x04U  /* allow local address reuse */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ip_8h_source.html#l00099">99</a> of file <a class="el" href="ip_8h_source.html">ip.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9feb530a8af39f237202b679b5be04a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9feb530a8af39f237202b679b5be04a1">&#9670;&nbsp;</a></span>ip_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="err_8h.html#af02d9da80fd66b4f986d2c53d7231ddb">err_t</a> ip_input </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpbuf.html">pbuf</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnetif.html">netif</a> *&#160;</td>
          <td class="paramname"><em>inp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is called by the network interface device driver when an IP packet is received. The function does the basic checks of the IP header such as packet size being at least larger than the header size etc. If the packet was not destined for us, the packet is forwarded (using ip_forward). The IP checksum is always checked.</p>
<p>Finally, the packet is sent to the upper layer protocol input function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>the received IP packet (p-&gt;payload points to IP header) </td></tr>
    <tr><td class="paramname">inp</td><td>the netif on which this packet was received </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERR_OK if the packet was processed (could return ERR_* if it wasn't processed, but currently always returns ERR_OK) </dd></dl>

<p class="definition">Definition at line <a class="el" href="ip_8c_source.html#l01071">1071</a> of file <a class="el" href="ip_8c_source.html">ip.c</a>.</p>

<p class="reference">References <a class="el" href="ip_8c_source.html#l00113">current_iphdr_dest</a>, <a class="el" href="ip_8c_source.html#l00111">current_iphdr_src</a>, <a class="el" href="err_8h_source.html#l00052">ERR_OK</a>, <a class="el" href="netif_8h_source.html#l00193">netif::flags</a>, <a class="el" href="icmp_8h_source.html#l00059">ICMP_DUR_PROTO</a>, <a class="el" href="inet__chksum_8c_source.html#l00396">inet_chksum()</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00181">ip4_addr_get_u32</a>, <a class="el" href="netif_8h_source.html#l00144">netif::ip_addr</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00198">ip_addr_cmp</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00162">ip_addr_copy</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00200">ip_addr_isany</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00202">ip_addr_isbroadcast</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00208">ip_addr_ismulticast</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00170">ip_addr_set_any</a>, <a class="el" href="opt_8h_source.html#l01883">IP_DEBUG</a>, <a class="el" href="ip_8h_source.html#l00206">ip_debug_print</a>, <a class="el" href="ip_8h_source.html#l00050">IP_HLEN</a>, <a class="el" href="ip_8h_source.html#l00127">IP_MF</a>, <a class="el" href="ip_8h_source.html#l00128">IP_OFFMASK</a>, <a class="el" href="ip_8h_source.html#l00052">IP_PROTO_ICMP</a>, <a class="el" href="ip_8h_source.html#l00053">IP_PROTO_IGMP</a>, <a class="el" href="ip_8h_source.html#l00056">IP_PROTO_TCP</a>, <a class="el" href="ip_8h_source.html#l00054">IP_PROTO_UDP</a>, <a class="el" href="ip_8h_source.html#l00055">IP_PROTO_UDPLITE</a>, <a class="el" href="stats_8h_source.html#l00203">IP_STATS_INC</a>, <a class="el" href="ip_8h_source.html#l00145">IPH_HL</a>, <a class="el" href="ip_8h_source.html#l00148">IPH_ID</a>, <a class="el" href="ip_8h_source.html#l00147">IPH_LEN</a>, <a class="el" href="ip_8h_source.html#l00149">IPH_OFFSET</a>, <a class="el" href="ip_8h_source.html#l00151">IPH_PROTO</a>, <a class="el" href="ip_8h_source.html#l00144">IPH_V</a>, <a class="el" href="pbuf_8h_source.html#l00093">pbuf::len</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00047">LWIP_DBG_LEVEL_SERIOUS</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00046">LWIP_DBG_LEVEL_WARNING</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00057">LWIP_DBG_TRACE</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">LWIP_DEBUGF</a>, <a class="el" href="netif_8h_source.html#l00195">netif::name</a>, <a class="el" href="netif_8h_source.html#l00095">NETIF_FLAG_IGMP</a>, <a class="el" href="netif_8h_source.html#l00286">netif_is_up</a>, <a class="el" href="netif_8c_source.html#l00075">netif_list</a>, <a class="el" href="netif_8h_source.html#l00145">netif::netmask</a>, <a class="el" href="netif_8h_source.html#l00141">netif::next</a>, <a class="el" href="def_8h_source.html#l00082">ntohs</a>, <a class="el" href="def_8h_source.html#l00047">NULL</a>, <a class="el" href="pbuf_8h_source.html#l00081">pbuf::payload</a>, <a class="el" href="pbuf_8c_source.html#l00685">pbuf_free()</a>, <a class="el" href="pbuf_8c_source.html#l00492">pbuf_realloc()</a>, <a class="el" href="def_8h_source.html#l00092">PP_HTONS</a>, <a class="el" href="snmp_8h_source.html#l00263">snmp_inc_ipinaddrerrors</a>, <a class="el" href="snmp_8h_source.html#l00267">snmp_inc_ipindelivers</a>, <a class="el" href="snmp_8h_source.html#l00266">snmp_inc_ipindiscards</a>, <a class="el" href="snmp_8h_source.html#l00262">snmp_inc_ipinhdrerrors</a>, <a class="el" href="snmp_8h_source.html#l00261">snmp_inc_ipinreceives</a>, <a class="el" href="snmp_8h_source.html#l00265">snmp_inc_ipinunknownprotos</a>, <a class="el" href="pbuf_8h_source.html#l00090">pbuf::tot_len</a>, <a class="el" href="cc_8h_source.html#l00061">U16_F</a>, <a class="el" href="cc_8h_source.html#l00062">X16_F</a>, and <a class="el" href="cc_8h_source.html#l00066">X32_F</a>.</p>

<p class="reference">Referenced by <a class="el" href="tcpip_8c_source.html#l00156">tcpip_input()</a>, <a class="el" href="tcpip_8c_source.html#l00074">tcpip_thread()</a>, and <a class="el" href="tunif_8c_source.html#l00097">tunif_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;{</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keyword">struct </span><a class="code" href="structip__hdr.html">ip_hdr</a> *iphdr;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keyword">struct </span><a class="code" href="structnetif.html">netif</a> *<a class="code" href="structnetif.html">netif</a>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <a class="code" href="cc_8h.html#afc6499c1f28697aa3bfc2804d496fd11">u16_t</a> iphdr_hlen;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <a class="code" href="cc_8h.html#afc6499c1f28697aa3bfc2804d496fd11">u16_t</a> iphdr_len;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="preprocessor">#if IP_ACCEPT_LINK_LAYER_ADDRESSING</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordtype">int</span> check_ip_src=1;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_ACCEPT_LINK_LAYER_ADDRESSING */</span><span class="preprocessor"></span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.recv);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <a class="code" href="snmp_8h.html#ae26db2056130a859c3d2a428b6af2457">snmp_inc_ipinreceives</a>();</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="comment">/* identify the IP header */</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  iphdr = (<span class="keyword">struct </span><a class="code" href="structip__hdr.html">ip_hdr</a> *)p-&gt;<a class="code" href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">payload</a>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  if (<a class="code" href="ip_8h.html#a05a9e8ecf4eff38244b4c13c7e70094c">IPH_V</a>(iphdr) != 4) {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a77c491e468bf7d9a1bc48430c1866a96">LWIP_DBG_LEVEL_WARNING</a>, (<span class="stringliteral">&quot;IP packet dropped due to bad version number %&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="ip_8h.html#a05a9e8ecf4eff38244b4c13c7e70094c">IPH_V</a>(iphdr)));</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <a class="code" href="ip_8h.html#a86a6ffcb10aab6f5a02c9b7d8e516f0a">ip_debug_print</a>(p);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="pbuf_8h.html#a0d26e00e2cf975274139d27ddabd7ed3">pbuf_free</a>(p);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.err);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.drop);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <a class="code" href="snmp_8h.html#a18197d75266e2b817b600697cb3b973f">snmp_inc_ipinhdrerrors</a>();</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">/* obtain IP header length in number of 32-bit words */</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  iphdr_hlen = <a class="code" href="ip_8h.html#a7c60caeb708571a07a44309c10ec3a01">IPH_HL</a>(iphdr);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="comment">/* calculate IP header length in bytes */</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  iphdr_hlen *= 4;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">/* obtain ip length in bytes */</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  iphdr_len = <a class="code" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(<a class="code" href="ip_8h.html#aec0328fe4711b8c1ef4dd6709e4fd6d5">IPH_LEN</a>(iphdr));</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="comment">/* header length exceeds first pbuf length, or ip length exceeds total pbuf length? */</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">if</span> ((iphdr_hlen &gt; p-&gt;<a class="code" href="structpbuf.html#a6f82449625e36e294f5d210268c0703f">len</a>) || (iphdr_len &gt; p-&gt;<a class="code" href="structpbuf.html#a5259e7ec29bab9c0999b64f2e86b411f">tot_len</a>)) {</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (iphdr_hlen &gt; p-&gt;<a class="code" href="structpbuf.html#a6f82449625e36e294f5d210268c0703f">len</a>) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>,</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        (<span class="stringliteral">&quot;IP header (len %&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;) does not fit in first pbuf (len %&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;), IP packet dropped.\n&quot;</span>,</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        iphdr_hlen, p-&gt;<a class="code" href="structpbuf.html#a6f82449625e36e294f5d210268c0703f">len</a>));</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordflow">if</span> (iphdr_len &gt; p-&gt;<a class="code" href="structpbuf.html#a5259e7ec29bab9c0999b64f2e86b411f">tot_len</a>) {</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>,</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        (<span class="stringliteral">&quot;IP (len %&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;) is longer than pbuf (len %&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;), IP packet dropped.\n&quot;</span>,</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        iphdr_len, p-&gt;<a class="code" href="structpbuf.html#a5259e7ec29bab9c0999b64f2e86b411f">tot_len</a>));</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    }</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">/* free (drop) packet pbufs */</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="pbuf_8h.html#a0d26e00e2cf975274139d27ddabd7ed3">pbuf_free</a>(p);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.lenerr);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.drop);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="snmp_8h.html#a4f0611bbaf85f153e98759354c0e3ea0">snmp_inc_ipindiscards</a>();</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a>;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="comment">/* verify checksum */</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="preprocessor">#if CHECKSUM_CHECK_IP</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="inet__chksum_8h.html#a79a1825a9588a77b8c372a3d708974a8">inet_chksum</a>(iphdr, iphdr_hlen) != 0) {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>,</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      (<span class="stringliteral">&quot;Checksum (0x%&quot;</span><a class="code" href="cc_8h.html#a1418f92673e54a36b6e376109e526382">X16_F</a><span class="stringliteral">&quot;) failed, IP packet dropped.\n&quot;</span>, <a class="code" href="inet__chksum_8h.html#a79a1825a9588a77b8c372a3d708974a8">inet_chksum</a>(iphdr, iphdr_hlen)));</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <a class="code" href="ip_8h.html#a86a6ffcb10aab6f5a02c9b7d8e516f0a">ip_debug_print</a>(p);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <a class="code" href="pbuf_8h.html#a0d26e00e2cf975274139d27ddabd7ed3">pbuf_free</a>(p);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.chkerr);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.drop);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="snmp_8h.html#a18197d75266e2b817b600697cb3b973f">snmp_inc_ipinhdrerrors</a>();</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a>;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  }</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="preprocessor">#if IP_NAPT</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="comment">/* for unicast packet, check NAPT table and modify dest if needed */</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keywordflow">if</span> (!inp-&gt;napt &amp;&amp; <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a008c9c92d770cc030ea054e6b259835a">ip_addr_cmp</a>(&amp;iphdr-&gt;dest, &amp;(inp-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>)))</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    ip_napt_recv(p, iphdr, netif);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="comment">/* Trim pbuf. This should have been done at the netif layer,</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">   * but we&#39;ll do it anyway just to be sure that its done. */</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <a class="code" href="pbuf_8h.html#a4853abdcdbbe0c4c9fc994e4e7e02b87">pbuf_realloc</a>(p, iphdr_len);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="comment">/* copy IP addresses to aligned ip_addr_t */</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a>(<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>, iphdr-&gt;dest);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a>(<a class="code" href="ip_8c.html#a312380e254b06dd3041065a3ec27264b">current_iphdr_src</a>, iphdr-&gt;src);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="comment">/* match packet against an interface, i.e. is this packet for us? */</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="preprocessor">#if LWIP_IGMP</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a312e629c950c8e0add5b5e5897334beb">ip_addr_ismulticast</a>(&amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>)) {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordflow">if</span> ((inp-&gt;<a class="code" href="structnetif.html#a1c171db6097bbb6f09f63549a66e00ea">flags</a> &amp; <a class="code" href="netif_8h.html#ac9493b923d733c73f6006d9714826558">NETIF_FLAG_IGMP</a>) &amp;&amp; (igmp_lookfor_group(inp, &amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>))) {</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      netif = inp;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      netif = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    }</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_IGMP */</span><span class="preprocessor"></span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  {</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="comment">/* start trying with inp. if that&#39;s not acceptable, start walking the</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">       list of configured netifs.</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">       &#39;first&#39; is used as a boolean to mark whether we started walking the list */</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordtype">int</span> first = 1;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    netif = inp;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;ip_input: iphdr-&gt;dest 0x%&quot;</span><a class="code" href="cc_8h.html#ac219830a93d05c5f18f64ce87a34be14">X32_F</a><span class="stringliteral">&quot; netif-&gt;ip_addr 0x%&quot;</span><a class="code" href="cc_8h.html#ac219830a93d05c5f18f64ce87a34be14">X32_F</a><span class="stringliteral">&quot; (0x%&quot;</span><a class="code" href="cc_8h.html#ac219830a93d05c5f18f64ce87a34be14">X32_F</a><span class="stringliteral">&quot;, 0x%&quot;</span><a class="code" href="cc_8h.html#ac219830a93d05c5f18f64ce87a34be14">X32_F</a><span class="stringliteral">&quot;, 0x%&quot;</span><a class="code" href="cc_8h.html#ac219830a93d05c5f18f64ce87a34be14">X32_F</a><span class="stringliteral">&quot;)\n&quot;</span>,</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;          <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;iphdr-&gt;dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;netif-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>),</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;          <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;iphdr-&gt;dest) &amp; <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;netif-&gt;<a class="code" href="structnetif.html#a5192f2fa2533f13cfde07d9d5bb0db2b">netmask</a>),</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;          <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;netif-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>) &amp; <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;netif-&gt;<a class="code" href="structnetif.html#a5192f2fa2533f13cfde07d9d5bb0db2b">netmask</a>),</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;          <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;iphdr-&gt;dest) &amp; ~<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;netif-&gt;<a class="code" href="structnetif.html#a5192f2fa2533f13cfde07d9d5bb0db2b">netmask</a>)));</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="comment">/* interface is up and configured? */</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a>(netif)) &amp;&amp; (!<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a0d51c2bb5f2af51392540af1c5df511a">ip_addr_isany</a>(&amp;(netif-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>)))) {</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="comment">/* unicast to this interface address? */</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a008c9c92d770cc030ea054e6b259835a">ip_addr_cmp</a>(&amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>, &amp;(netif-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>)) ||</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <span class="comment">/* or broadcast on this interface network address? */</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa3345706e3aa8b32dd630c195b053e75">ip_addr_isbroadcast</a>(&amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>, netif)) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;          <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;ip_input: packet accepted on interface %c%c\n&quot;</span>,</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;              netif-&gt;<a class="code" href="structnetif.html#a32fca6ffd28bb9af3f891a378827a67e">name</a>[0], netif-&gt;<a class="code" href="structnetif.html#a32fca6ffd28bb9af3f891a378827a67e">name</a>[1]));</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          <span class="comment">/* break out of for loop */</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="preprocessor">#if LWIP_AUTOIP</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="comment">/* connections to link-local addresses must persist after changing</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">           the netif&#39;s address (RFC3927 ch. 1.9) */</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="keywordflow">if</span> ((netif-&gt;autoip != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a008c9c92d770cc030ea054e6b259835a">ip_addr_cmp</a>(&amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>, &amp;(netif-&gt;autoip-&gt;llipaddr))) {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;          <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;ip_input: LLA packet accepted on interface %c%c\n&quot;</span>,</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;              netif-&gt;<a class="code" href="structnetif.html#a32fca6ffd28bb9af3f891a378827a67e">name</a>[0], netif-&gt;<a class="code" href="structnetif.html#a32fca6ffd28bb9af3f891a378827a67e">name</a>[1]));</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;          <span class="comment">/* break out of for loop */</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        }</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_AUTOIP */</span><span class="preprocessor"></span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      }</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <span class="keywordflow">if</span> (first) {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        first = 0;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        netif = <a class="code" href="netif_8h.html#a1c8141eaa98f6dc6dfddbb23a706656c">netif_list</a>;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        netif = netif-&gt;<a class="code" href="structnetif.html#ae77736b64df442242795220d76be6b86">next</a>;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keywordflow">if</span> (netif == inp) {</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        netif = netif-&gt;<a class="code" href="structnetif.html#ae77736b64df442242795220d76be6b86">next</a>;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      }</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    } <span class="keywordflow">while</span>(netif != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  }</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="preprocessor">#if IP_ACCEPT_LINK_LAYER_ADDRESSING</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">/* Pass DHCP messages regardless of destination address. DHCP traffic is addressed</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">   * using link layer addressing (such as Ethernet MAC) so we must not filter on IP.</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">   * According to RFC 1542 section 3.1.1, referred by RFC 2131).</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">   * If you want to accept private broadcast communication while a netif is down,</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">   * define LWIP_IP_ACCEPT_UDP_PORT(dst_port), e.g.:</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">   * #define LWIP_IP_ACCEPT_UDP_PORT(dst_port) ((dst_port) == PP_NTOHS(12345))</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">if</span> (netif == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">/* remote port is DHCP server? */</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ip_8h.html#aa2de6f9d35337b4be67d799805665e11">IPH_PROTO</a>(iphdr) == <a class="code" href="ip_8h.html#a76212e7ef71a99646040d2e454388bed">IP_PROTO_UDP</a>) {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="keyword">struct </span>udp_hdr *udphdr = (<span class="keyword">struct </span>udp_hdr *)((<a class="code" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> *)iphdr + iphdr_hlen);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a988147559b78642ac881815b66023646">LWIP_DBG_TRACE</a>, (<span class="stringliteral">&quot;ip_input: UDP packet to DHCP client port %&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <a class="code" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(udphdr-&gt;dest)));</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="keywordflow">if</span> (IP_ACCEPT_LINK_LAYER_ADDRESSED_PORT(udphdr-&gt;dest)) {</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a988147559b78642ac881815b66023646">LWIP_DBG_TRACE</a>, (<span class="stringliteral">&quot;ip_input: DHCP packet accepted.\n&quot;</span>));</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        netif = inp;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        check_ip_src = 0;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      }</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    }</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  }</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_ACCEPT_LINK_LAYER_ADDRESSING */</span><span class="preprocessor"></span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="comment">/* broadcast or multicast packet source address? Compliant with RFC 1122: 3.2.1.3 */</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="preprocessor">#if IP_ACCEPT_LINK_LAYER_ADDRESSING</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="comment">/* DHCP servers need 0.0.0.0 to be allowed as source address (RFC 1.1.2.2: 3.2.1.3/a) */</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="keywordflow">if</span> (check_ip_src &amp;&amp; !<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a0d51c2bb5f2af51392540af1c5df511a">ip_addr_isany</a>(&amp;<a class="code" href="ip_8c.html#a312380e254b06dd3041065a3ec27264b">current_iphdr_src</a>))</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_ACCEPT_LINK_LAYER_ADDRESSING */</span><span class="preprocessor"></span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  {  <span class="keywordflow">if</span> ((<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa3345706e3aa8b32dd630c195b053e75">ip_addr_isbroadcast</a>(&amp;<a class="code" href="ip_8c.html#a312380e254b06dd3041065a3ec27264b">current_iphdr_src</a>, inp)) ||</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;         (<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a312e629c950c8e0add5b5e5897334beb">ip_addr_ismulticast</a>(&amp;<a class="code" href="ip_8c.html#a312380e254b06dd3041065a3ec27264b">current_iphdr_src</a>))) {</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <span class="comment">/* packet source is not valid */</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a988147559b78642ac881815b66023646">LWIP_DBG_TRACE</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a77c491e468bf7d9a1bc48430c1866a96">LWIP_DBG_LEVEL_WARNING</a>, (<span class="stringliteral">&quot;ip_input: packet source is not valid.\n&quot;</span>));</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="comment">/* free (drop) packet pbufs */</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <a class="code" href="pbuf_8h.html#a0d26e00e2cf975274139d27ddabd7ed3">pbuf_free</a>(p);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.drop);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <a class="code" href="snmp_8h.html#a6dea294bdc2cb0faf95c794da9d9d6df">snmp_inc_ipinaddrerrors</a>();</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <a class="code" href="snmp_8h.html#a4f0611bbaf85f153e98759354c0e3ea0">snmp_inc_ipindiscards</a>();</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a>;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  }</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="comment">/* packet not for us? */</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="keywordflow">if</span> (netif == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="comment">/* packet not for us, route or discard */</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a988147559b78642ac881815b66023646">LWIP_DBG_TRACE</a>, (<span class="stringliteral">&quot;ip_input: packet not for us.\n&quot;</span>));</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="preprocessor">#if IP_FORWARD</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="comment">/* non-broadcast packet? */</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa3345706e3aa8b32dd630c195b053e75">ip_addr_isbroadcast</a>(&amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>, inp)) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="comment">/* try to forward IP packet on (other) interfaces */</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      ip_forward(p, iphdr, inp);</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_FORWARD */</span><span class="preprocessor"></span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    {</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <a class="code" href="snmp_8h.html#a6dea294bdc2cb0faf95c794da9d9d6df">snmp_inc_ipinaddrerrors</a>();</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <a class="code" href="snmp_8h.html#a4f0611bbaf85f153e98759354c0e3ea0">snmp_inc_ipindiscards</a>();</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <a class="code" href="pbuf_8h.html#a0d26e00e2cf975274139d27ddabd7ed3">pbuf_free</a>(p);</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a>;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  }</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="comment">/* packet consists of multiple fragments? */</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ip_8h.html#a559dce3878f1d6a46bcb4cb312962397">IPH_OFFSET</a>(iphdr) &amp; <a class="code" href="def_8h.html#a0dfd02d7c09f9c698a5a7ecc0b7287ad">PP_HTONS</a>(<a class="code" href="ip_8h.html#ad059798b16d1f615b5af8770175121ba">IP_OFFMASK</a> | <a class="code" href="ip_8h.html#ae8afe1e04bb9bad791443556c3b2cd73">IP_MF</a>)) != 0) {</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="preprocessor">#if IP_REASSEMBLY </span><span class="comment">/* packet fragment reassembly code present? */</span><span class="preprocessor"></span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;IP packet is a fragment (id=0x%04&quot;</span><a class="code" href="cc_8h.html#a1418f92673e54a36b6e376109e526382">X16_F</a><span class="stringliteral">&quot; tot_len=%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot; len=%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot; MF=%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot; offset=%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;), calling ip_reass()\n&quot;</span>,</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <a class="code" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(<a class="code" href="ip_8h.html#ae79eaecc0bf9e4dbb9e47ea56ad2157a">IPH_ID</a>(iphdr)), p-&gt;<a class="code" href="structpbuf.html#a5259e7ec29bab9c0999b64f2e86b411f">tot_len</a>, <a class="code" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(<a class="code" href="ip_8h.html#aec0328fe4711b8c1ef4dd6709e4fd6d5">IPH_LEN</a>(iphdr)), !!(<a class="code" href="ip_8h.html#a559dce3878f1d6a46bcb4cb312962397">IPH_OFFSET</a>(iphdr) &amp; <a class="code" href="def_8h.html#a0dfd02d7c09f9c698a5a7ecc0b7287ad">PP_HTONS</a>(<a class="code" href="ip_8h.html#ae8afe1e04bb9bad791443556c3b2cd73">IP_MF</a>)), (<a class="code" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(<a class="code" href="ip_8h.html#a559dce3878f1d6a46bcb4cb312962397">IPH_OFFSET</a>(iphdr)) &amp; <a class="code" href="ip_8h.html#ad059798b16d1f615b5af8770175121ba">IP_OFFMASK</a>)*8));</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="comment">/* reassemble the packet*/</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    p = ip_reass(p);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">/* packet not fully reassembled yet? */</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">if</span> (p == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a>;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    }</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    iphdr = (<span class="keyword">struct </span><a class="code" href="structip__hdr.html">ip_hdr</a> *)p-&gt;<a class="code" href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">payload</a>;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;#<span class="keywordflow">else</span> <span class="comment">/* IP_REASSEMBLY == 0, no packet fragment reassembly code present */</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <a class="code" href="pbuf_8h.html#a0d26e00e2cf975274139d27ddabd7ed3">pbuf_free</a>(p);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>, (<span class="stringliteral">&quot;IP packet dropped since it was fragmented (0x%&quot;</span><a class="code" href="cc_8h.html#a1418f92673e54a36b6e376109e526382">X16_F</a><span class="stringliteral">&quot;) (while IP_REASSEMBLY == 0).\n&quot;</span>,</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <a class="code" href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a>(<a class="code" href="ip_8h.html#a559dce3878f1d6a46bcb4cb312962397">IPH_OFFSET</a>(iphdr))));</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.opterr);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.drop);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="comment">/* unsupported protocol feature */</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <a class="code" href="snmp_8h.html#a81855509aa976e3e237c7f4105dbda7d">snmp_inc_ipinunknownprotos</a>();</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a>;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_REASSEMBLY */</span><span class="preprocessor"></span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  }</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="preprocessor">#if IP_OPTIONS_ALLOWED == 0 </span><span class="comment">/* no support for IP options in the IP header? */</span><span class="preprocessor"></span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="preprocessor">#if LWIP_IGMP</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="comment">/* there is an extra &quot;router alert&quot; option in IGMP messages which we allow for but do not police */</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordflow">if</span>((iphdr_hlen &gt; <a class="code" href="ip_8h.html#ad76777d4d34f33ab5f715f9ca15503c3">IP_HLEN</a>) &amp;&amp;  (<a class="code" href="ip_8h.html#aa2de6f9d35337b4be67d799805665e11">IPH_PROTO</a>(iphdr) != <a class="code" href="ip_8h.html#a4f8609139fce15ace0c6d117021e29a4">IP_PROTO_IGMP</a>)) {</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">if</span> (iphdr_hlen &gt; <a class="code" href="ip_8h.html#ad76777d4d34f33ab5f715f9ca15503c3">IP_HLEN</a>) {</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_IGMP */</span><span class="preprocessor"></span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>, (<span class="stringliteral">&quot;IP packet dropped since there were IP options (while IP_OPTIONS_ALLOWED == 0).\n&quot;</span>));</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <a class="code" href="pbuf_8h.html#a0d26e00e2cf975274139d27ddabd7ed3">pbuf_free</a>(p);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.opterr);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.drop);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">/* unsupported protocol feature */</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <a class="code" href="snmp_8h.html#a81855509aa976e3e237c7f4105dbda7d">snmp_inc_ipinunknownprotos</a>();</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a>;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  }</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_OPTIONS_ALLOWED == 0 */</span><span class="preprocessor"></span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="comment">/* send to upper layers */</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;ip_input: \n&quot;</span>));</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <a class="code" href="ip_8h.html#a86a6ffcb10aab6f5a02c9b7d8e516f0a">ip_debug_print</a>(p);</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;ip_input: p-&gt;len %&quot;</span>U16_F<span class="stringliteral">&quot; p-&gt;tot_len %&quot;</span>U16_F<span class="stringliteral">&quot;\n&quot;</span>, p-&gt;<a class="code" href="structpbuf.html#a6f82449625e36e294f5d210268c0703f">len</a>, p-&gt;<a class="code" href="structpbuf.html#a5259e7ec29bab9c0999b64f2e86b411f">tot_len</a>));</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <a class="code" href="ip_8c.html#aabce496c19c6ae4000174c8af8a4a913">current_netif</a> = inp;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <a class="code" href="ip_8c.html#a169cfb7f1ed23bc514e3e567644291af">current_header</a> = iphdr;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="preprocessor">#if LWIP_RAW</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="comment">/* raw input did not eat the packet? */</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keywordflow">if</span> (raw_input(p, inp) == 0)</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_RAW */</span><span class="preprocessor"></span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  {</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="ip_8h.html#aa2de6f9d35337b4be67d799805665e11">IPH_PROTO</a>(iphdr)) {</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="preprocessor">#if LWIP_UDP</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ip_8h.html#a76212e7ef71a99646040d2e454388bed">IP_PROTO_UDP</a>:</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="preprocessor">#if LWIP_UDPLITE</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ip_8h.html#a3ef2b8a1cb4f7acee3142337438dfd0d">IP_PROTO_UDPLITE</a>:</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDPLITE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <a class="code" href="snmp_8h.html#a2cc69ed07172b463e7de49268319ad74">snmp_inc_ipindelivers</a>();</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      udp_input(p, inp);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_UDP */</span><span class="preprocessor"></span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="preprocessor">#if LWIP_TCP</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ip_8h.html#a634284ee3a136d6ad61bc5d917ebb82f">IP_PROTO_TCP</a>:</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <a class="code" href="snmp_8h.html#a2cc69ed07172b463e7de49268319ad74">snmp_inc_ipindelivers</a>();</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      tcp_input(p, inp);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_TCP */</span><span class="preprocessor"></span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="preprocessor">#if LWIP_ICMP</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ip_8h.html#aacaea7b8c4c8a5229c02b653766b4793">IP_PROTO_ICMP</a>:</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      <a class="code" href="snmp_8h.html#a2cc69ed07172b463e7de49268319ad74">snmp_inc_ipindelivers</a>();</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      icmp_input(p, inp);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_ICMP */</span><span class="preprocessor"></span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="preprocessor">#if LWIP_IGMP</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ip_8h.html#a4f8609139fce15ace0c6d117021e29a4">IP_PROTO_IGMP</a>:</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      igmp_input(p, inp, &amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>);</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_IGMP */</span><span class="preprocessor"></span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="preprocessor">#if LWIP_ICMP</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="comment">/* send ICMP destination protocol unreachable unless is was a broadcast */</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa3345706e3aa8b32dd630c195b053e75">ip_addr_isbroadcast</a>(&amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>, inp) &amp;&amp;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;          !<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a312e629c950c8e0add5b5e5897334beb">ip_addr_ismulticast</a>(&amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>)) {</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        p-&gt;<a class="code" href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">payload</a> = iphdr;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        icmp_dest_unreach(p, <a class="code" href="icmp_8h.html#a17637465f209385e5d19ef47fd9266a5a3c7bbd13b613990413ef167017dfbcef">ICMP_DUR_PROTO</a>);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      }</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_ICMP */</span><span class="preprocessor"></span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <a class="code" href="pbuf_8h.html#a0d26e00e2cf975274139d27ddabd7ed3">pbuf_free</a>(p);</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>, (<span class="stringliteral">&quot;Unsupported transport protocol %&quot;</span>U16_F<span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="ip_8h.html#aa2de6f9d35337b4be67d799805665e11">IPH_PROTO</a>(iphdr)));</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.proterr);</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.drop);</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <a class="code" href="snmp_8h.html#a81855509aa976e3e237c7f4105dbda7d">snmp_inc_ipinunknownprotos</a>();</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    }</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <a class="code" href="ip_8c.html#aabce496c19c6ae4000174c8af8a4a913">current_netif</a> = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <a class="code" href="ip_8c.html#a169cfb7f1ed23bc514e3e567644291af">current_header</a> = <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa53183915f12b05c753b76c743c2a0f6">ip_addr_set_any</a>(&amp;<a class="code" href="ip_8c.html#a312380e254b06dd3041065a3ec27264b">current_iphdr_src</a>);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa53183915f12b05c753b76c743c2a0f6">ip_addr_set_any</a>(&amp;<a class="code" href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a>);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a>;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;}</div><div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_ad50d93464bbbda199b585c54869a3a4b"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a></div><div class="ttdeci">#define ip4_addr_get_u32(src_ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00181">ip_addr.h:181</a></div></div>
<div class="ttc" id="ip_8h_html_aacaea7b8c4c8a5229c02b653766b4793"><div class="ttname"><a href="ip_8h.html#aacaea7b8c4c8a5229c02b653766b4793">IP_PROTO_ICMP</a></div><div class="ttdeci">#define IP_PROTO_ICMP</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00052">ip.h:52</a></div></div>
<div class="ttc" id="structpbuf_html_a5259e7ec29bab9c0999b64f2e86b411f"><div class="ttname"><a href="structpbuf.html#a5259e7ec29bab9c0999b64f2e86b411f">pbuf::tot_len</a></div><div class="ttdeci">u16_t tot_len</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00090">pbuf.h:90</a></div></div>
<div class="ttc" id="ip_8h_html_ae8afe1e04bb9bad791443556c3b2cd73"><div class="ttname"><a href="ip_8h.html#ae8afe1e04bb9bad791443556c3b2cd73">IP_MF</a></div><div class="ttdeci">#define IP_MF</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00127">ip.h:127</a></div></div>
<div class="ttc" id="ip_8c_html_aabce496c19c6ae4000174c8af8a4a913"><div class="ttname"><a href="ip_8c.html#aabce496c19c6ae4000174c8af8a4a913">current_netif</a></div><div class="ttdeci">struct netif * current_netif</div><div class="ttdef"><b>Definition:</b> <a href="ip_8c_source.html#l00104">ip.c:104</a></div></div>
<div class="ttc" id="structpbuf_html_a6f82449625e36e294f5d210268c0703f"><div class="ttname"><a href="structpbuf.html#a6f82449625e36e294f5d210268c0703f">pbuf::len</a></div><div class="ttdeci">u16_t len</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00093">pbuf.h:93</a></div></div>
<div class="ttc" id="ip_8h_html_a05a9e8ecf4eff38244b4c13c7e70094c"><div class="ttname"><a href="ip_8h.html#a05a9e8ecf4eff38244b4c13c7e70094c">IPH_V</a></div><div class="ttdeci">#define IPH_V(hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00144">ip.h:144</a></div></div>
<div class="ttc" id="inet__chksum_8h_html_a79a1825a9588a77b8c372a3d708974a8"><div class="ttname"><a href="inet__chksum_8h.html#a79a1825a9588a77b8c372a3d708974a8">inet_chksum</a></div><div class="ttdeci">u16_t inet_chksum(void *dataptr, u16_t len) ICACHE_FLASH_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="inet__chksum_8c_source.html#l00396">inet_chksum.c:396</a></div></div>
<div class="ttc" id="cc_8h_html_aa9d7f6eb2ee9fcc5eda3545dbb1886e0"><div class="ttname"><a href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a></div><div class="ttdeci">#define U16_F</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00061">cc.h:61</a></div></div>
<div class="ttc" id="netif_8h_html_a1c8141eaa98f6dc6dfddbb23a706656c"><div class="ttname"><a href="netif_8h.html#a1c8141eaa98f6dc6dfddbb23a706656c">netif_list</a></div><div class="ttdeci">struct netif * netif_list</div><div class="ttdef"><b>Definition:</b> <a href="netif_8c_source.html#l00075">netif.c:75</a></div></div>
<div class="ttc" id="def_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00047">def.h:47</a></div></div>
<div class="ttc" id="ip_8h_html_a634284ee3a136d6ad61bc5d917ebb82f"><div class="ttname"><a href="ip_8h.html#a634284ee3a136d6ad61bc5d917ebb82f">IP_PROTO_TCP</a></div><div class="ttdeci">#define IP_PROTO_TCP</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00056">ip.h:56</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a988147559b78642ac881815b66023646"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a988147559b78642ac881815b66023646">LWIP_DBG_TRACE</a></div><div class="ttdeci">#define LWIP_DBG_TRACE</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00057">debug.h:57</a></div></div>
<div class="ttc" id="ip_8h_html_a7c60caeb708571a07a44309c10ec3a01"><div class="ttname"><a href="ip_8h.html#a7c60caeb708571a07a44309c10ec3a01">IPH_HL</a></div><div class="ttdeci">#define IPH_HL(hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00145">ip.h:145</a></div></div>
<div class="ttc" id="ip_8h_html_a4f8609139fce15ace0c6d117021e29a4"><div class="ttname"><a href="ip_8h.html#a4f8609139fce15ace0c6d117021e29a4">IP_PROTO_IGMP</a></div><div class="ttdeci">#define IP_PROTO_IGMP</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00053">ip.h:53</a></div></div>
<div class="ttc" id="snmp_8h_html_ae26db2056130a859c3d2a428b6af2457"><div class="ttname"><a href="snmp_8h.html#ae26db2056130a859c3d2a428b6af2457">snmp_inc_ipinreceives</a></div><div class="ttdeci">#define snmp_inc_ipinreceives()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00261">snmp.h:261</a></div></div>
<div class="ttc" id="opt_8h_html_a5d3348778951e7bc5cd397c6575eef3a"><div class="ttname"><a href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a></div><div class="ttdeci">#define IP_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l01883">opt.h:1883</a></div></div>
<div class="ttc" id="def_8h_html_a0dfd02d7c09f9c698a5a7ecc0b7287ad"><div class="ttname"><a href="def_8h.html#a0dfd02d7c09f9c698a5a7ecc0b7287ad">PP_HTONS</a></div><div class="ttdeci">#define PP_HTONS(x)</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00092">def.h:92</a></div></div>
<div class="ttc" id="snmp_8h_html_a2cc69ed07172b463e7de49268319ad74"><div class="ttname"><a href="snmp_8h.html#a2cc69ed07172b463e7de49268319ad74">snmp_inc_ipindelivers</a></div><div class="ttdeci">#define snmp_inc_ipindelivers()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00267">snmp.h:267</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a63a04edf7ff63c951bd8706711956cdb"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a></div><div class="ttdeci">#define LWIP_DEBUGF(debug, message)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">debug.h:95</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a008c9c92d770cc030ea054e6b259835a"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a008c9c92d770cc030ea054e6b259835a">ip_addr_cmp</a></div><div class="ttdeci">#define ip_addr_cmp(addr1, addr2)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00198">ip_addr.h:198</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a77a933975db287f6aa5c2e70249ba18f"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a></div><div class="ttdeci">#define ip_addr_copy(dest, src)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00162">ip_addr.h:162</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a0269bdc51f1e8a5ecf9af72c6e1c996c"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a></div><div class="ttdeci">#define LWIP_DBG_LEVEL_SERIOUS</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00047">debug.h:47</a></div></div>
<div class="ttc" id="structnetif_html_ae77736b64df442242795220d76be6b86"><div class="ttname"><a href="structnetif.html#ae77736b64df442242795220d76be6b86">netif::next</a></div><div class="ttdeci">struct netif * next</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00141">netif.h:141</a></div></div>
<div class="ttc" id="err_8h_html_a98c763adfeea8e9831c46ec269e47ae9"><div class="ttname"><a href="err_8h.html#a98c763adfeea8e9831c46ec269e47ae9">ERR_OK</a></div><div class="ttdeci">#define ERR_OK</div><div class="ttdef"><b>Definition:</b> <a href="err_8h_source.html#l00052">err.h:52</a></div></div>
<div class="ttc" id="ip_8h_html_aec0328fe4711b8c1ef4dd6709e4fd6d5"><div class="ttname"><a href="ip_8h.html#aec0328fe4711b8c1ef4dd6709e4fd6d5">IPH_LEN</a></div><div class="ttdeci">#define IPH_LEN(hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00147">ip.h:147</a></div></div>
<div class="ttc" id="ip_8h_html_ad059798b16d1f615b5af8770175121ba"><div class="ttname"><a href="ip_8h.html#ad059798b16d1f615b5af8770175121ba">IP_OFFMASK</a></div><div class="ttdeci">#define IP_OFFMASK</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00128">ip.h:128</a></div></div>
<div class="ttc" id="structnetif_html_a1c171db6097bbb6f09f63549a66e00ea"><div class="ttname"><a href="structnetif.html#a1c171db6097bbb6f09f63549a66e00ea">netif::flags</a></div><div class="ttdeci">u8_t flags</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00193">netif.h:193</a></div></div>
<div class="ttc" id="snmp_8h_html_a18197d75266e2b817b600697cb3b973f"><div class="ttname"><a href="snmp_8h.html#a18197d75266e2b817b600697cb3b973f">snmp_inc_ipinhdrerrors</a></div><div class="ttdeci">#define snmp_inc_ipinhdrerrors()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00262">snmp.h:262</a></div></div>
<div class="ttc" id="ip_8h_html_a86a6ffcb10aab6f5a02c9b7d8e516f0a"><div class="ttname"><a href="ip_8h.html#a86a6ffcb10aab6f5a02c9b7d8e516f0a">ip_debug_print</a></div><div class="ttdeci">#define ip_debug_print(p)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00206">ip.h:206</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_aa53183915f12b05c753b76c743c2a0f6"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa53183915f12b05c753b76c743c2a0f6">ip_addr_set_any</a></div><div class="ttdeci">#define ip_addr_set_any(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00170">ip_addr.h:170</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a77c491e468bf7d9a1bc48430c1866a96"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a77c491e468bf7d9a1bc48430c1866a96">LWIP_DBG_LEVEL_WARNING</a></div><div class="ttdeci">#define LWIP_DBG_LEVEL_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00046">debug.h:46</a></div></div>
<div class="ttc" id="structnetif_html"><div class="ttname"><a href="structnetif.html">netif</a></div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00139">netif.h:139</a></div></div>
<div class="ttc" id="netif_8h_html_ac9493b923d733c73f6006d9714826558"><div class="ttname"><a href="netif_8h.html#ac9493b923d733c73f6006d9714826558">NETIF_FLAG_IGMP</a></div><div class="ttdeci">#define NETIF_FLAG_IGMP</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00095">netif.h:95</a></div></div>
<div class="ttc" id="structnetif_html_a9776aaee37ea8f07b9ddc0f8b4e7e866"><div class="ttname"><a href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">netif::ip_addr</a></div><div class="ttdeci">ip_addr_t ip_addr</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00144">netif.h:144</a></div></div>
<div class="ttc" id="snmp_8h_html_a4f0611bbaf85f153e98759354c0e3ea0"><div class="ttname"><a href="snmp_8h.html#a4f0611bbaf85f153e98759354c0e3ea0">snmp_inc_ipindiscards</a></div><div class="ttdeci">#define snmp_inc_ipindiscards()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00266">snmp.h:266</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a0d51c2bb5f2af51392540af1c5df511a"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a0d51c2bb5f2af51392540af1c5df511a">ip_addr_isany</a></div><div class="ttdeci">#define ip_addr_isany(addr1)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00200">ip_addr.h:200</a></div></div>
<div class="ttc" id="icmp_8h_html_a17637465f209385e5d19ef47fd9266a5a3c7bbd13b613990413ef167017dfbcef"><div class="ttname"><a href="icmp_8h.html#a17637465f209385e5d19ef47fd9266a5a3c7bbd13b613990413ef167017dfbcef">ICMP_DUR_PROTO</a></div><div class="ttdef"><b>Definition:</b> <a href="icmp_8h_source.html#l00059">icmp.h:59</a></div></div>
<div class="ttc" id="snmp_8h_html_a81855509aa976e3e237c7f4105dbda7d"><div class="ttname"><a href="snmp_8h.html#a81855509aa976e3e237c7f4105dbda7d">snmp_inc_ipinunknownprotos</a></div><div class="ttdeci">#define snmp_inc_ipinunknownprotos()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00265">snmp.h:265</a></div></div>
<div class="ttc" id="pbuf_8h_html_a0d26e00e2cf975274139d27ddabd7ed3"><div class="ttname"><a href="pbuf_8h.html#a0d26e00e2cf975274139d27ddabd7ed3">pbuf_free</a></div><div class="ttdeci">u8_t pbuf_free(struct pbuf *p) ICACHE_FLASH_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8c_source.html#l00685">pbuf.c:685</a></div></div>
<div class="ttc" id="ip_8c_html_a312380e254b06dd3041065a3ec27264b"><div class="ttname"><a href="ip_8c.html#a312380e254b06dd3041065a3ec27264b">current_iphdr_src</a></div><div class="ttdeci">ip_addr_t current_iphdr_src</div><div class="ttdef"><b>Definition:</b> <a href="ip_8c_source.html#l00111">ip.c:111</a></div></div>
<div class="ttc" id="ip_8h_html_a76212e7ef71a99646040d2e454388bed"><div class="ttname"><a href="ip_8h.html#a76212e7ef71a99646040d2e454388bed">IP_PROTO_UDP</a></div><div class="ttdeci">#define IP_PROTO_UDP</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00054">ip.h:54</a></div></div>
<div class="ttc" id="snmp_8h_html_a6dea294bdc2cb0faf95c794da9d9d6df"><div class="ttname"><a href="snmp_8h.html#a6dea294bdc2cb0faf95c794da9d9d6df">snmp_inc_ipinaddrerrors</a></div><div class="ttdeci">#define snmp_inc_ipinaddrerrors()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00263">snmp.h:263</a></div></div>
<div class="ttc" id="ip_8c_html_a63c0914cf407e33af9b47061bd6ae40d"><div class="ttname"><a href="ip_8c.html#a63c0914cf407e33af9b47061bd6ae40d">current_iphdr_dest</a></div><div class="ttdeci">ip_addr_t current_iphdr_dest</div><div class="ttdef"><b>Definition:</b> <a href="ip_8c_source.html#l00113">ip.c:113</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_aa3345706e3aa8b32dd630c195b053e75"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa3345706e3aa8b32dd630c195b053e75">ip_addr_isbroadcast</a></div><div class="ttdeci">#define ip_addr_isbroadcast(ipaddr, netif)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00202">ip_addr.h:202</a></div></div>
<div class="ttc" id="structip__hdr_html"><div class="ttname"><a href="structip__hdr.html">ip_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00116">ip.h:116</a></div></div>
<div class="ttc" id="ip_8h_html_ad76777d4d34f33ab5f715f9ca15503c3"><div class="ttname"><a href="ip_8h.html#ad76777d4d34f33ab5f715f9ca15503c3">IP_HLEN</a></div><div class="ttdeci">#define IP_HLEN</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00050">ip.h:50</a></div></div>
<div class="ttc" id="ip_8h_html_a559dce3878f1d6a46bcb4cb312962397"><div class="ttname"><a href="ip_8h.html#a559dce3878f1d6a46bcb4cb312962397">IPH_OFFSET</a></div><div class="ttdeci">#define IPH_OFFSET(hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00149">ip.h:149</a></div></div>
<div class="ttc" id="cc_8h_html_ae081489b4906f65a3cb18e9fbe9f8d23"><div class="ttname"><a href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a></div><div class="ttdeci">unsigned char u8_t</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00052">cc.h:52</a></div></div>
<div class="ttc" id="structpbuf_html_a8d32dc3e964369d4eec638fc37fbc460"><div class="ttname"><a href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">pbuf::payload</a></div><div class="ttdeci">void * payload</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00081">pbuf.h:81</a></div></div>
<div class="ttc" id="stats_8h_html_af0a2079f449ce75c1eb49b8a5c922de8"><div class="ttname"><a href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a></div><div class="ttdeci">#define IP_STATS_INC(x)</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00203">stats.h:203</a></div></div>
<div class="ttc" id="structnetif_html_a32fca6ffd28bb9af3f891a378827a67e"><div class="ttname"><a href="structnetif.html#a32fca6ffd28bb9af3f891a378827a67e">netif::name</a></div><div class="ttdeci">char name[2]</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00195">netif.h:195</a></div></div>
<div class="ttc" id="ip_8h_html_a3ef2b8a1cb4f7acee3142337438dfd0d"><div class="ttname"><a href="ip_8h.html#a3ef2b8a1cb4f7acee3142337438dfd0d">IP_PROTO_UDPLITE</a></div><div class="ttdeci">#define IP_PROTO_UDPLITE</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00055">ip.h:55</a></div></div>
<div class="ttc" id="structnetif_html_a5192f2fa2533f13cfde07d9d5bb0db2b"><div class="ttname"><a href="structnetif.html#a5192f2fa2533f13cfde07d9d5bb0db2b">netif::netmask</a></div><div class="ttdeci">ip_addr_t netmask</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00145">netif.h:145</a></div></div>
<div class="ttc" id="netif_8h_html_a94a4c24c988afc0a577387730f303b19"><div class="ttname"><a href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a></div><div class="ttdeci">#define netif_is_up(netif)</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00286">netif.h:286</a></div></div>
<div class="ttc" id="cc_8h_html_ac219830a93d05c5f18f64ce87a34be14"><div class="ttname"><a href="cc_8h.html#ac219830a93d05c5f18f64ce87a34be14">X32_F</a></div><div class="ttdeci">#define X32_F</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00066">cc.h:66</a></div></div>
<div class="ttc" id="pbuf_8h_html_a4853abdcdbbe0c4c9fc994e4e7e02b87"><div class="ttname"><a href="pbuf_8h.html#a4853abdcdbbe0c4c9fc994e4e7e02b87">pbuf_realloc</a></div><div class="ttdeci">void pbuf_realloc(struct pbuf *p, u16_t size) ICACHE_FLASH_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8c_source.html#l00492">pbuf.c:492</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a312e629c950c8e0add5b5e5897334beb"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a312e629c950c8e0add5b5e5897334beb">ip_addr_ismulticast</a></div><div class="ttdeci">#define ip_addr_ismulticast(addr1)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00208">ip_addr.h:208</a></div></div>
<div class="ttc" id="ip_8c_html_a169cfb7f1ed23bc514e3e567644291af"><div class="ttname"><a href="ip_8c.html#a169cfb7f1ed23bc514e3e567644291af">current_header</a></div><div class="ttdeci">const struct ip_hdr * current_header</div><div class="ttdef"><b>Definition:</b> <a href="ip_8c_source.html#l00109">ip.c:109</a></div></div>
<div class="ttc" id="def_8h_html_ada37feda716b4ba89cf9dba34288141d"><div class="ttname"><a href="def_8h.html#ada37feda716b4ba89cf9dba34288141d">ntohs</a></div><div class="ttdeci">#define ntohs(x)</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00082">def.h:82</a></div></div>
<div class="ttc" id="ip_8h_html_aa2de6f9d35337b4be67d799805665e11"><div class="ttname"><a href="ip_8h.html#aa2de6f9d35337b4be67d799805665e11">IPH_PROTO</a></div><div class="ttdeci">#define IPH_PROTO(hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00151">ip.h:151</a></div></div>
<div class="ttc" id="cc_8h_html_afc6499c1f28697aa3bfc2804d496fd11"><div class="ttname"><a href="cc_8h.html#afc6499c1f28697aa3bfc2804d496fd11">u16_t</a></div><div class="ttdeci">unsigned short u16_t</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00054">cc.h:54</a></div></div>
<div class="ttc" id="cc_8h_html_a1418f92673e54a36b6e376109e526382"><div class="ttname"><a href="cc_8h.html#a1418f92673e54a36b6e376109e526382">X16_F</a></div><div class="ttdeci">#define X16_F</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00062">cc.h:62</a></div></div>
<div class="ttc" id="ip_8h_html_ae79eaecc0bf9e4dbb9e47ea56ad2157a"><div class="ttname"><a href="ip_8h.html#ae79eaecc0bf9e4dbb9e47ea56ad2157a">IPH_ID</a></div><div class="ttdeci">#define IPH_ID(hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00148">ip.h:148</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h_a9feb530a8af39f237202b679b5be04a1_cgraph.svg" width="616" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h_a9feb530a8af39f237202b679b5be04a1_icgraph.svg" width="342" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a832a0012dc03b2b9428ca9cfb36e5182"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a832a0012dc03b2b9428ca9cfb36e5182">&#9670;&nbsp;</a></span>ip_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="err_8h.html#af02d9da80fd66b4f986d2c53d7231ddb">err_t</a> ip_output </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpbuf.html">pbuf</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>&#160;</td>
          <td class="paramname"><em>ttl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>&#160;</td>
          <td class="paramname"><em>tos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>&#160;</td>
          <td class="paramname"><em>proto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Simple interface to ip_output_if. It finds the outgoing network interface and calls upon ip_output_if to do the actual work.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>the packet to send (p-&gt;payload points to the data, e.g. next protocol header; if dest == IP_HDRINCL, p already includes an IP header and p-&gt;payload points to that IP header) </td></tr>
    <tr><td class="paramname">src</td><td>the source IP address to send from (if src == IP_ADDR_ANY, the IP address of the netif used to send is used as source address) </td></tr>
    <tr><td class="paramname">dest</td><td>the destination IP address to send the packet to </td></tr>
    <tr><td class="paramname">ttl</td><td>the TTL value to be set in the IP header </td></tr>
    <tr><td class="paramname">tos</td><td>the TOS value to be set in the IP header </td></tr>
    <tr><td class="paramname">proto</td><td>the PROTOCOL to be set in the IP header</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERR_RTE if no route is found see <a class="el" href="ip_8c.html#a4bb5579127e9d605d66c275c1393e114">ip_output_if()</a> for more return values </dd></dl>

<p class="definition">Definition at line <a class="el" href="ip_8c_source.html#l01592">1592</a> of file <a class="el" href="ip_8c_source.html">ip.c</a>.</p>

<p class="reference">References <a class="el" href="err_8h_source.html#l00056">ERR_RTE</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00226">ip4_addr1_16</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00227">ip4_addr2_16</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00228">ip4_addr3_16</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00229">ip4_addr4_16</a>, <a class="el" href="opt_8h_source.html#l01883">IP_DEBUG</a>, <a class="el" href="ip_8h_source.html#l00206">ip_debug_print</a>, <a class="el" href="ip_8h_source.html#l00050">IP_HLEN</a>, <a class="el" href="ip_8h_source.html#l00128">IP_OFFMASK</a>, <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>, <a class="el" href="ip_8c_source.html#l00177">ip_route()</a>, <a class="el" href="stats_8h_source.html#l00203">IP_STATS_INC</a>, <a class="el" href="ip_8h_source.html#l00152">IPH_CHKSUM</a>, <a class="el" href="ip_8h_source.html#l00145">IPH_HL</a>, <a class="el" href="ip_8h_source.html#l00148">IPH_ID</a>, <a class="el" href="ip_8h_source.html#l00147">IPH_LEN</a>, <a class="el" href="ip_8h_source.html#l00149">IPH_OFFSET</a>, <a class="el" href="ip_8h_source.html#l00151">IPH_PROTO</a>, <a class="el" href="ip_8h_source.html#l00146">IPH_TOS</a>, <a class="el" href="ip_8h_source.html#l00150">IPH_TTL</a>, <a class="el" href="ip_8h_source.html#l00144">IPH_V</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00066">LWIP_ASSERT</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">LWIP_DEBUGF</a>, <a class="el" href="opt_8h_source.html#l02059">NAPT_DEBUG</a>, <a class="el" href="ip_8h_source.html#l00212">napt_debug_print</a>, <a class="el" href="def_8h_source.html#l00082">ntohs</a>, <a class="el" href="def_8h_source.html#l00047">NULL</a>, <a class="el" href="pbuf_8h_source.html#l00081">pbuf::payload</a>, <a class="el" href="def_8h_source.html#l00092">PP_HTONS</a>, <a class="el" href="pbuf_8h_source.html#l00106">pbuf::ref</a>, <a class="el" href="cc_8h_source.html#l00060">S16_F</a>, <a class="el" href="cc_8h_source.html#l00061">U16_F</a>, and <a class="el" href="cc_8h_source.html#l00062">X16_F</a>.</p>
<div class="fragment"><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;{</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="keyword">struct </span><a class="code" href="structnetif.html">netif</a> *<a class="code" href="structnetif.html">netif</a>;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="comment">/* pbufs passed to IP must have a ref-count of 1 as their payload pointer</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">     gets altered as the packet is passed down the stack */</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a94ad086267808462beae2b38f91996ed">LWIP_ASSERT</a>(<span class="stringliteral">&quot;p-&gt;ref == 1&quot;</span>, p-&gt;<a class="code" href="structpbuf.html#a18e2c02942feb1baa3756fcd585b6731">ref</a> == 1);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="keywordflow">if</span> ((netif = <a class="code" href="ip_8c.html#affb2e1bbfe28242fd8f1e7459e60736e">ip_route</a>(dest)) == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;ip_output: No route to %&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;.%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;.%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;.%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a15d6d219310ffb5a225cdc13404072dc">ip4_addr1_16</a>(dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3d0584d6d81c59b05824d65b95fedb63">ip4_addr2_16</a>(dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aab3a41c7d715de7fa8de42600be7c189">ip4_addr3_16</a>(dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad063f9120ca605616531abe3e4860dc9">ip4_addr4_16</a>(dest)));</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.rterr);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="err_8h.html#a99462c1105f849cc0db4c87261e0b63d">ERR_RTE</a>;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  }</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ip_8c.html#a4bb5579127e9d605d66c275c1393e114">ip_output_if</a>(p, src, dest, ttl, tos, proto, netif);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;}</div><div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_aab3a41c7d715de7fa8de42600be7c189"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aab3a41c7d715de7fa8de42600be7c189">ip4_addr3_16</a></div><div class="ttdeci">#define ip4_addr3_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00228">ip_addr.h:228</a></div></div>
<div class="ttc" id="ip_8c_html_a4bb5579127e9d605d66c275c1393e114"><div class="ttname"><a href="ip_8c.html#a4bb5579127e9d605d66c275c1393e114">ip_output_if</a></div><div class="ttdeci">err_t ip_output_if(struct pbuf *p, ip_addr_t *src, ip_addr_t *dest, u8_t ttl, u8_t tos, u8_t proto, struct netif *netif)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8c_source.html#l01406">ip.c:1406</a></div></div>
<div class="ttc" id="cc_8h_html_aa9d7f6eb2ee9fcc5eda3545dbb1886e0"><div class="ttname"><a href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a></div><div class="ttdeci">#define U16_F</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00061">cc.h:61</a></div></div>
<div class="ttc" id="def_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00047">def.h:47</a></div></div>
<div class="ttc" id="opt_8h_html_a5d3348778951e7bc5cd397c6575eef3a"><div class="ttname"><a href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a></div><div class="ttdeci">#define IP_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l01883">opt.h:1883</a></div></div>
<div class="ttc" id="ip_8c_html_affb2e1bbfe28242fd8f1e7459e60736e"><div class="ttname"><a href="ip_8c.html#affb2e1bbfe28242fd8f1e7459e60736e">ip_route</a></div><div class="ttdeci">struct netif *ICACHE_FLASH_ATTR ip_route(ip_addr_t *dest)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8c_source.html#l00177">ip.c:177</a></div></div>
<div class="ttc" id="err_8h_html_a99462c1105f849cc0db4c87261e0b63d"><div class="ttname"><a href="err_8h.html#a99462c1105f849cc0db4c87261e0b63d">ERR_RTE</a></div><div class="ttdeci">#define ERR_RTE</div><div class="ttdef"><b>Definition:</b> <a href="err_8h_source.html#l00056">err.h:56</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a63a04edf7ff63c951bd8706711956cdb"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a></div><div class="ttdeci">#define LWIP_DEBUGF(debug, message)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">debug.h:95</a></div></div>
<div class="ttc" id="structnetif_html"><div class="ttname"><a href="structnetif.html">netif</a></div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00139">netif.h:139</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_ad063f9120ca605616531abe3e4860dc9"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad063f9120ca605616531abe3e4860dc9">ip4_addr4_16</a></div><div class="ttdeci">#define ip4_addr4_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00229">ip_addr.h:229</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a15d6d219310ffb5a225cdc13404072dc"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a15d6d219310ffb5a225cdc13404072dc">ip4_addr1_16</a></div><div class="ttdeci">#define ip4_addr1_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00226">ip_addr.h:226</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a94ad086267808462beae2b38f91996ed"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a94ad086267808462beae2b38f91996ed">LWIP_ASSERT</a></div><div class="ttdeci">#define LWIP_ASSERT(message, assertion)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00066">debug.h:66</a></div></div>
<div class="ttc" id="stats_8h_html_af0a2079f449ce75c1eb49b8a5c922de8"><div class="ttname"><a href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a></div><div class="ttdeci">#define IP_STATS_INC(x)</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00203">stats.h:203</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a3d0584d6d81c59b05824d65b95fedb63"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3d0584d6d81c59b05824d65b95fedb63">ip4_addr2_16</a></div><div class="ttdeci">#define ip4_addr2_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00227">ip_addr.h:227</a></div></div>
<div class="ttc" id="structpbuf_html_a18e2c02942feb1baa3756fcd585b6731"><div class="ttname"><a href="structpbuf.html#a18e2c02942feb1baa3756fcd585b6731">pbuf::ref</a></div><div class="ttdeci">u16_t ref</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00106">pbuf.h:106</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h_a832a0012dc03b2b9428ca9cfb36e5182_cgraph.svg" width="530" height="164"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0e401f7437b993011d343f78f6647a76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e401f7437b993011d343f78f6647a76">&#9670;&nbsp;</a></span>ip_output_if()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="err_8h.html#af02d9da80fd66b4f986d2c53d7231ddb">err_t</a> ip_output_if </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structpbuf.html">pbuf</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>&#160;</td>
          <td class="paramname"><em>ttl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>&#160;</td>
          <td class="paramname"><em>tos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a>&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnetif.html">netif</a> *&#160;</td>
          <td class="paramname"><em>netif</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sends an IP packet on a network interface. This function constructs the IP header and calculates the IP header checksum. If the source IP address is NULL, the IP address of the outgoing network interface is filled in as source address. If the destination IP address is IP_HDRINCL, p is assumed to already include an IP header and p-&gt;payload points to it instead of the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>the packet to send (p-&gt;payload points to the data, e.g. next protocol header; if dest == IP_HDRINCL, p already includes an IP header and p-&gt;payload points to that IP header) </td></tr>
    <tr><td class="paramname">src</td><td>the source IP address to send from (if src == IP_ADDR_ANY, the IP address of the netif used to send is used as source address) </td></tr>
    <tr><td class="paramname">dest</td><td>the destination IP address to send the packet to </td></tr>
    <tr><td class="paramname">ttl</td><td>the TTL value to be set in the IP header </td></tr>
    <tr><td class="paramname">tos</td><td>the TOS value to be set in the IP header </td></tr>
    <tr><td class="paramname">proto</td><td>the PROTOCOL to be set in the IP header </td></tr>
    <tr><td class="paramname">netif</td><td>the netif on which to send this packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERR_OK if the packet was sent OK ERR_BUF if p doesn't have enough space for IP/LINK headers returns errors returned by netif-&gt;output</dd></dl>
<dl class="section note"><dt>Note</dt><dd>ip_id: RFC791 "some host may be able to simply use
 unique identifiers independent of destination" </dd></dl>

<p class="definition">Definition at line <a class="el" href="ip_8c_source.html#l01406">1406</a> of file <a class="el" href="ip_8c_source.html">ip.c</a>.</p>

<p class="reference">References <a class="el" href="err_8h_source.html#l00054">ERR_BUF</a>, <a class="el" href="pbuf_8h_source.html#l00099">pbuf::flags</a>, <a class="el" href="def_8h_source.html#l00081">htons</a>, <a class="el" href="inet__chksum_8c_source.html#l00396">inet_chksum()</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00181">ip4_addr_get_u32</a>, <a class="el" href="netif_8h_source.html#l00144">netif::ip_addr</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00198">ip_addr_cmp</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00162">ip_addr_copy</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00200">ip_addr_isany</a>, <a class="el" href="opt_8h_source.html#l01883">IP_DEBUG</a>, <a class="el" href="ip_8h_source.html#l00206">ip_debug_print</a>, <a class="el" href="ip_8h_source.html#l00064">IP_HDRINCL</a>, <a class="el" href="ip_8h_source.html#l00050">IP_HLEN</a>, <a class="el" href="ip_8c_source.html#l00116">ip_id</a>, <a class="el" href="ip_8c_source.html#l00177">ip_route()</a>, <a class="el" href="stats_8h_source.html#l00203">IP_STATS_INC</a>, <a class="el" href="ip_8h_source.html#l00160">IPH_CHKSUM_SET</a>, <a class="el" href="ip_8h_source.html#l00156">IPH_ID_SET</a>, <a class="el" href="ip_8h_source.html#l00155">IPH_LEN_SET</a>, <a class="el" href="ip_8h_source.html#l00157">IPH_OFFSET_SET</a>, <a class="el" href="ip_8h_source.html#l00159">IPH_PROTO_SET</a>, <a class="el" href="ip_8h_source.html#l00158">IPH_TTL_SET</a>, <a class="el" href="ip_8h_source.html#l00154">IPH_VHLTOS_SET</a>, <a class="el" href="pbuf_8h_source.html#l00093">pbuf::len</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00066">LWIP_ASSERT</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00047">LWIP_DBG_LEVEL_SERIOUS</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">LWIP_DEBUGF</a>, <a class="el" href="def_8h_source.html#l00056">LWIP_MAKE_U16</a>, <a class="el" href="opt_8h_source.html#l00084">MEMCPY</a>, <a class="el" href="netif_8h_source.html#l00187">netif::mtu</a>, <a class="el" href="netif_8h_source.html#l00195">netif::name</a>, <a class="el" href="def_8h_source.html#l00047">NULL</a>, <a class="el" href="netif_8h_source.html#l00197">netif::num</a>, <a class="el" href="osapi_8h_source.html#l00055">os_memset</a>, <a class="el" href="netif_8h_source.html#l00154">netif::output</a>, <a class="el" href="pbuf_8h_source.html#l00081">pbuf::payload</a>, <a class="el" href="pbuf_8h_source.html#l00074">PBUF_FLAG_MCASTLOOP</a>, <a class="el" href="pbuf_8c_source.html#l00573">pbuf_header()</a>, <a class="el" href="pbuf_8h_source.html#l00106">pbuf::ref</a>, <a class="el" href="snmp_8h_source.html#l00269">snmp_inc_ipoutdiscards</a>, <a class="el" href="snmp_8h_source.html#l00268">snmp_inc_ipoutrequests</a>, <a class="el" href="pbuf_8h_source.html#l00090">pbuf::tot_len</a>, and <a class="el" href="cc_8h_source.html#l00061">U16_F</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>.</p>
<div class="fragment"><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;{</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="preprocessor">#if IP_OPTIONS_SEND</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <span class="keywordflow">return</span> ip_output_if_opt(p, src, dest, ttl, tos, proto, netif, <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;}</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment"> * Same as ip_output_if() but with the possibility to include IP options:</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment"> * @ param ip_options pointer to the IP options, copied into the IP header</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment"> * @ param optlen length of ip_options</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<a class="code" href="err_8h.html#af02d9da80fd66b4f986d2c53d7231ddb">err_t</a> ip_output_if_opt(<span class="keyword">struct</span> <a class="code" href="structpbuf.html">pbuf</a> *p, <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *src, <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *dest,</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;       <a class="code" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> ttl, <a class="code" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> tos, <a class="code" href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a> proto, <span class="keyword">struct</span> netif *netif, <span class="keywordtype">void</span> *ip_options,</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;       <a class="code" href="cc_8h.html#afc6499c1f28697aa3bfc2804d496fd11">u16_t</a> optlen)</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;{</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_OPTIONS_SEND */</span><span class="preprocessor"></span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <span class="keyword">struct </span><a class="code" href="structip__hdr.html">ip_hdr</a> *iphdr;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> dest_addr;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP_INLINE</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <a class="code" href="cc_8h.html#ad671004a6ae37e115124e92627bac407">u32_t</a> chk_sum = 0;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="comment">/* pbufs passed to IP must have a ref-count of 1 as their payload pointer</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">     gets altered as the packet is passed down the stack */</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a94ad086267808462beae2b38f91996ed">LWIP_ASSERT</a>(<span class="stringliteral">&quot;p-&gt;ref == 1&quot;</span>, p-&gt;<a class="code" href="structpbuf.html#a18e2c02942feb1baa3756fcd585b6731">ref</a> == 1);</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <a class="code" href="snmp_8h.html#a50ec8161ad8d406d8bbfba5991c97e98">snmp_inc_ipoutrequests</a>();</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="comment">/* Should the IP header be generated or is it already included in p? */</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="keywordflow">if</span> (dest != <a class="code" href="ip_8h.html#a4c4294940df109ad673a7295b74259b0">IP_HDRINCL</a>) {</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <a class="code" href="cc_8h.html#afc6499c1f28697aa3bfc2804d496fd11">u16_t</a> ip_hlen = <a class="code" href="ip_8h.html#ad76777d4d34f33ab5f715f9ca15503c3">IP_HLEN</a>;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="preprocessor">#if IP_OPTIONS_SEND</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <a class="code" href="cc_8h.html#afc6499c1f28697aa3bfc2804d496fd11">u16_t</a> optlen_aligned = 0;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (optlen != 0) {</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP_INLINE</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="comment">/* round up to a multiple of 4 */</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      optlen_aligned = ((optlen + 3) &amp; ~3);</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      ip_hlen += optlen_aligned;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      <span class="comment">/* First write in the IP options */</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="pbuf_8h.html#a2e8fb29db85437c62b7dfc80e8257deb">pbuf_header</a>(p, optlen_aligned)) {</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>, (<span class="stringliteral">&quot;ip_output_if_opt: not enough room for IP options in pbuf\n&quot;</span>));</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.err);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <a class="code" href="snmp_8h.html#ad3763daf784aee4daf7385790d88f9fc">snmp_inc_ipoutdiscards</a>();</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="err_8h.html#ae1dcf352601ec4d3b700910df24f863d">ERR_BUF</a>;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      }</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <a class="code" href="opt_8h.html#aa1dd57a66b6de8c0593e9e3e8d1411f6">MEMCPY</a>(p-&gt;<a class="code" href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">payload</a>, ip_options, optlen);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <span class="keywordflow">if</span> (optlen &lt; optlen_aligned) {</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="comment">/* zero the remaining bytes */</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <a class="code" href="osapi_8h.html#a8b6e05160473ebb1f7f87ca232f87c7b">os_memset</a>(((<span class="keywordtype">char</span>*)p-&gt;<a class="code" href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">payload</a>) + optlen, 0, optlen_aligned - optlen);</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      }</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP_INLINE</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; optlen_aligned/2; i++) {</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        chk_sum += ((<a class="code" href="cc_8h.html#afc6499c1f28697aa3bfc2804d496fd11">u16_t</a>*)p-&gt;<a class="code" href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">payload</a>)[i];</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      }</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    }</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_OPTIONS_SEND */</span><span class="preprocessor"></span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="comment">/* generate IP header */</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="pbuf_8h.html#a2e8fb29db85437c62b7dfc80e8257deb">pbuf_header</a>(p, <a class="code" href="ip_8h.html#ad76777d4d34f33ab5f715f9ca15503c3">IP_HLEN</a>)) {</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>, (<span class="stringliteral">&quot;ip_output: not enough room for IP header in pbuf\n&quot;</span>));</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.err);</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <a class="code" href="snmp_8h.html#ad3763daf784aee4daf7385790d88f9fc">snmp_inc_ipoutdiscards</a>();</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="err_8h.html#ae1dcf352601ec4d3b700910df24f863d">ERR_BUF</a>;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    }</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    iphdr = (<span class="keyword">struct </span><a class="code" href="structip__hdr.html">ip_hdr</a> *)p-&gt;<a class="code" href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">payload</a>;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a94ad086267808462beae2b38f91996ed">LWIP_ASSERT</a>(<span class="stringliteral">&quot;check that first pbuf can hold struct ip_hdr&quot;</span>,</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;               (p-&gt;<a class="code" href="structpbuf.html#a6f82449625e36e294f5d210268c0703f">len</a> &gt;= <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structip__hdr.html">ip_hdr</a>)));</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <a class="code" href="ip_8h.html#aa0e49f03bd4c3144e3548a0db72d1deb">IPH_TTL_SET</a>(iphdr, ttl);</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <a class="code" href="ip_8h.html#a49753f7668f741b1877340bff6fb97c3">IPH_PROTO_SET</a>(iphdr, proto);</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP_INLINE</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    chk_sum += <a class="code" href="def_8h.html#a50bb84f05471465a5cb441421274954d">LWIP_MAKE_U16</a>(proto, ttl);</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">/* dest cannot be NULL here */</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a>(iphdr-&gt;dest, *dest);</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP_INLINE</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    chk_sum += <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;iphdr-&gt;dest) &amp; 0xFFFF;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    chk_sum += <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;iphdr-&gt;dest) &gt;&gt; 16;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <a class="code" href="ip_8h.html#a65a5ff431603908b698b69ff5151f888">IPH_VHLTOS_SET</a>(iphdr, 4, ip_hlen / 4, tos);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP_INLINE</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    chk_sum += iphdr-&gt;_v_hl_tos;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="ip_8h.html#a069cb9b3765c4bdd63d13efb2df0206e">IPH_LEN_SET</a>(iphdr, <a class="code" href="def_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(p-&gt;<a class="code" href="structpbuf.html#a5259e7ec29bab9c0999b64f2e86b411f">tot_len</a>));</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP_INLINE</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    chk_sum += iphdr-&gt;_len;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <a class="code" href="ip_8h.html#a4c2189e1400dca1c0f785de96ceda2b6">IPH_OFFSET_SET</a>(iphdr, 0);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <a class="code" href="ip_8h.html#a3b2c57b6a9dc9cc32fc2f145a96bbf8f">IPH_ID_SET</a>(iphdr, <a class="code" href="def_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(<a class="code" href="ip_8c.html#ada6867ff3417696aabaa551b4b9558d3">ip_id</a>));</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP_INLINE</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    chk_sum += iphdr-&gt;_id;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    ++<a class="code" href="ip_8c.html#ada6867ff3417696aabaa551b4b9558d3">ip_id</a>;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a0d51c2bb5f2af51392540af1c5df511a">ip_addr_isany</a>(src)) {</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a>(iphdr-&gt;src, netif-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>);</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      <span class="comment">/* src cannot be NULL here */</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a>(iphdr-&gt;src, *src);</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    }</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP_INLINE</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    chk_sum += <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;iphdr-&gt;src) &amp; 0xFFFF;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    chk_sum += <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a>(&amp;iphdr-&gt;src) &gt;&gt; 16;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    chk_sum = (chk_sum &gt;&gt; 16) + (chk_sum &amp; 0xFFFF);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    chk_sum = (chk_sum &gt;&gt; 16) + chk_sum;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    chk_sum = ~chk_sum;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    iphdr-&gt;_chksum = chk_sum; <span class="comment">/* network order */</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <a class="code" href="ip_8h.html#aec30403fb98b013bd094688de55cdaef">IPH_CHKSUM_SET</a>(iphdr, 0);</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="preprocessor">#if CHECKSUM_GEN_IP</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <a class="code" href="ip_8h.html#aec30403fb98b013bd094688de55cdaef">IPH_CHKSUM_SET</a>(iphdr, <a class="code" href="inet__chksum_8h.html#a79a1825a9588a77b8c372a3d708974a8">inet_chksum</a>(iphdr, ip_hlen));</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CHECKSUM_GEN_IP_INLINE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="comment">/* IP header already included in p */</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    iphdr = (<span class="keyword">struct </span><a class="code" href="structip__hdr.html">ip_hdr</a> *)p-&gt;<a class="code" href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">payload</a>;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a>(dest_addr, iphdr-&gt;dest);</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    dest = &amp;dest_addr;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  }</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="preprocessor">#ifdef IP_ROUTING_TAB</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="keyword">struct </span>netif *new_netif = <a class="code" href="ip_8c.html#affb2e1bbfe28242fd8f1e7459e60736e">ip_route</a>(dest);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a008c9c92d770cc030ea054e6b259835a">ip_addr_cmp</a>(dest, &amp;current_ip_new_dest)) {</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="comment">//os_printf_plus(&quot;We changeed the routing in ip_output_if_opt\r\n&quot;);</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a>(*dest, current_ip_new_dest);</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    netif = new_netif;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  }</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.xmit);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;ip_output_if: %c%c%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;\n&quot;</span>, netif-&gt;<a class="code" href="structnetif.html#a32fca6ffd28bb9af3f891a378827a67e">name</a>[0], netif-&gt;<a class="code" href="structnetif.html#a32fca6ffd28bb9af3f891a378827a67e">name</a>[1], netif-&gt;<a class="code" href="structnetif.html#ab7ef01e505dd2feb781fe86756b1c973">num</a>));</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <a class="code" href="ip_8h.html#a86a6ffcb10aab6f5a02c9b7d8e516f0a">ip_debug_print</a>(p);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="preprocessor">#if 0 &amp;&amp; ENABLE_LOOPBACK</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="comment">/* doesn&#39;t work for external wifi interfaces */</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a008c9c92d770cc030ea054e6b259835a">ip_addr_cmp</a>(dest, &amp;netif-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>)) {</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">/* Packet to self, enqueue it for loopback */</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;netif_loop_output()&quot;</span>));</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">return</span> netif_loop_output(netif, p, dest);</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  }</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="preprocessor">#if LWIP_IGMP</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordflow">if</span> ((p-&gt;<a class="code" href="structpbuf.html#aa4d1af2cab3d9280d29212095b5b872a">flags</a> &amp; <a class="code" href="pbuf_8h.html#ab8ad153151a8c157335d9c0cedc007e6">PBUF_FLAG_MCASTLOOP</a>) != 0) {</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    netif_loop_output(netif, p, dest);</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  }</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LWIP_IGMP */</span><span class="preprocessor"></span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ENABLE_LOOPBACK */</span><span class="preprocessor"></span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="preprocessor">#if IP_FRAG</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="comment">/* don&#39;t fragment if interface has mtu set to 0 [loopif] */</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="keywordflow">if</span> (netif-&gt;<a class="code" href="structnetif.html#aca7d56b4e0f822b0ced2885f222b8d48">mtu</a> &amp;&amp; (p-&gt;<a class="code" href="structpbuf.html#a5259e7ec29bab9c0999b64f2e86b411f">tot_len</a> &gt; netif-&gt;<a class="code" href="structnetif.html#aca7d56b4e0f822b0ced2885f222b8d48">mtu</a>)) {</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordflow">return</span> ip_frag(p, netif, dest);</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  }</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_FRAG */</span><span class="preprocessor"></span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a>, (<span class="stringliteral">&quot;netif-&gt;output()\n&quot;</span>));</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keywordflow">return</span> netif-&gt;<a class="code" href="structnetif.html#a8e1dcfe65db487feecd244355f39215e">output</a>(netif, p, dest);</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;}</div><div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_ad50d93464bbbda199b585c54869a3a4b"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad50d93464bbbda199b585c54869a3a4b">ip4_addr_get_u32</a></div><div class="ttdeci">#define ip4_addr_get_u32(src_ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00181">ip_addr.h:181</a></div></div>
<div class="ttc" id="ip_8c_html_ada6867ff3417696aabaa551b4b9558d3"><div class="ttname"><a href="ip_8c.html#ada6867ff3417696aabaa551b4b9558d3">ip_id</a></div><div class="ttdeci">static u16_t ip_id</div><div class="ttdef"><b>Definition:</b> <a href="ip_8c_source.html#l00116">ip.c:116</a></div></div>
<div class="ttc" id="structpbuf_html_a5259e7ec29bab9c0999b64f2e86b411f"><div class="ttname"><a href="structpbuf.html#a5259e7ec29bab9c0999b64f2e86b411f">pbuf::tot_len</a></div><div class="ttdeci">u16_t tot_len</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00090">pbuf.h:90</a></div></div>
<div class="ttc" id="structpbuf_html_a6f82449625e36e294f5d210268c0703f"><div class="ttname"><a href="structpbuf.html#a6f82449625e36e294f5d210268c0703f">pbuf::len</a></div><div class="ttdeci">u16_t len</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00093">pbuf.h:93</a></div></div>
<div class="ttc" id="inet__chksum_8h_html_a79a1825a9588a77b8c372a3d708974a8"><div class="ttname"><a href="inet__chksum_8h.html#a79a1825a9588a77b8c372a3d708974a8">inet_chksum</a></div><div class="ttdeci">u16_t inet_chksum(void *dataptr, u16_t len) ICACHE_FLASH_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="inet__chksum_8c_source.html#l00396">inet_chksum.c:396</a></div></div>
<div class="ttc" id="cc_8h_html_aa9d7f6eb2ee9fcc5eda3545dbb1886e0"><div class="ttname"><a href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a></div><div class="ttdeci">#define U16_F</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00061">cc.h:61</a></div></div>
<div class="ttc" id="ip_8h_html_a65a5ff431603908b698b69ff5151f888"><div class="ttname"><a href="ip_8h.html#a65a5ff431603908b698b69ff5151f888">IPH_VHLTOS_SET</a></div><div class="ttdeci">#define IPH_VHLTOS_SET(hdr, v, hl, tos)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00154">ip.h:154</a></div></div>
<div class="ttc" id="def_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00047">def.h:47</a></div></div>
<div class="ttc" id="def_8h_html_a51799f5ebb4c7228ef7e95c247030f42"><div class="ttname"><a href="def_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a></div><div class="ttdeci">#define htons(x)</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00081">def.h:81</a></div></div>
<div class="ttc" id="structnetif_html_a8e1dcfe65db487feecd244355f39215e"><div class="ttname"><a href="structnetif.html#a8e1dcfe65db487feecd244355f39215e">netif::output</a></div><div class="ttdeci">netif_output_fn output</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00154">netif.h:154</a></div></div>
<div class="ttc" id="snmp_8h_html_ad3763daf784aee4daf7385790d88f9fc"><div class="ttname"><a href="snmp_8h.html#ad3763daf784aee4daf7385790d88f9fc">snmp_inc_ipoutdiscards</a></div><div class="ttdeci">#define snmp_inc_ipoutdiscards()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00269">snmp.h:269</a></div></div>
<div class="ttc" id="ip_8h_html_a49753f7668f741b1877340bff6fb97c3"><div class="ttname"><a href="ip_8h.html#a49753f7668f741b1877340bff6fb97c3">IPH_PROTO_SET</a></div><div class="ttdeci">#define IPH_PROTO_SET(hdr, proto)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00159">ip.h:159</a></div></div>
<div class="ttc" id="structnetif_html_ab7ef01e505dd2feb781fe86756b1c973"><div class="ttname"><a href="structnetif.html#ab7ef01e505dd2feb781fe86756b1c973">netif::num</a></div><div class="ttdeci">u8_t num</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00197">netif.h:197</a></div></div>
<div class="ttc" id="ip_8h_html_a4c4294940df109ad673a7295b74259b0"><div class="ttname"><a href="ip_8h.html#a4c4294940df109ad673a7295b74259b0">IP_HDRINCL</a></div><div class="ttdeci">#define IP_HDRINCL</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00064">ip.h:64</a></div></div>
<div class="ttc" id="opt_8h_html_a5d3348778951e7bc5cd397c6575eef3a"><div class="ttname"><a href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a></div><div class="ttdeci">#define IP_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l01883">opt.h:1883</a></div></div>
<div class="ttc" id="ip_8c_html_affb2e1bbfe28242fd8f1e7459e60736e"><div class="ttname"><a href="ip_8c.html#affb2e1bbfe28242fd8f1e7459e60736e">ip_route</a></div><div class="ttdeci">struct netif *ICACHE_FLASH_ATTR ip_route(ip_addr_t *dest)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8c_source.html#l00177">ip.c:177</a></div></div>
<div class="ttc" id="pbuf_8h_html_ab8ad153151a8c157335d9c0cedc007e6"><div class="ttname"><a href="pbuf_8h.html#ab8ad153151a8c157335d9c0cedc007e6">PBUF_FLAG_MCASTLOOP</a></div><div class="ttdeci">#define PBUF_FLAG_MCASTLOOP</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00074">pbuf.h:74</a></div></div>
<div class="ttc" id="structpbuf_html_aa4d1af2cab3d9280d29212095b5b872a"><div class="ttname"><a href="structpbuf.html#aa4d1af2cab3d9280d29212095b5b872a">pbuf::flags</a></div><div class="ttdeci">u8_t flags</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00099">pbuf.h:99</a></div></div>
<div class="ttc" id="cc_8h_html_ad671004a6ae37e115124e92627bac407"><div class="ttname"><a href="cc_8h.html#ad671004a6ae37e115124e92627bac407">u32_t</a></div><div class="ttdeci">unsigned long u32_t</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00056">cc.h:56</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a63a04edf7ff63c951bd8706711956cdb"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a></div><div class="ttdeci">#define LWIP_DEBUGF(debug, message)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">debug.h:95</a></div></div>
<div class="ttc" id="osapi_8h_html_a8b6e05160473ebb1f7f87ca232f87c7b"><div class="ttname"><a href="osapi_8h.html#a8b6e05160473ebb1f7f87ca232f87c7b">os_memset</a></div><div class="ttdeci">#define os_memset</div><div class="ttdef"><b>Definition:</b> <a href="osapi_8h_source.html#l00055">osapi.h:55</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a008c9c92d770cc030ea054e6b259835a"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a008c9c92d770cc030ea054e6b259835a">ip_addr_cmp</a></div><div class="ttdeci">#define ip_addr_cmp(addr1, addr2)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00198">ip_addr.h:198</a></div></div>
<div class="ttc" id="ip_8h_html_a4c2189e1400dca1c0f785de96ceda2b6"><div class="ttname"><a href="ip_8h.html#a4c2189e1400dca1c0f785de96ceda2b6">IPH_OFFSET_SET</a></div><div class="ttdeci">#define IPH_OFFSET_SET(hdr, off)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00157">ip.h:157</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a77a933975db287f6aa5c2e70249ba18f"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a></div><div class="ttdeci">#define ip_addr_copy(dest, src)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00162">ip_addr.h:162</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a0269bdc51f1e8a5ecf9af72c6e1c996c"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a></div><div class="ttdeci">#define LWIP_DBG_LEVEL_SERIOUS</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00047">debug.h:47</a></div></div>
<div class="ttc" id="structpbuf_html"><div class="ttname"><a href="structpbuf.html">pbuf</a></div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00076">pbuf.h:76</a></div></div>
<div class="ttc" id="err_8h_html_af02d9da80fd66b4f986d2c53d7231ddb"><div class="ttname"><a href="err_8h.html#af02d9da80fd66b4f986d2c53d7231ddb">err_t</a></div><div class="ttdeci">s8_t err_t</div><div class="ttdef"><b>Definition:</b> <a href="err_8h_source.html#l00047">err.h:47</a></div></div>
<div class="ttc" id="ip_8h_html_a86a6ffcb10aab6f5a02c9b7d8e516f0a"><div class="ttname"><a href="ip_8h.html#a86a6ffcb10aab6f5a02c9b7d8e516f0a">ip_debug_print</a></div><div class="ttdeci">#define ip_debug_print(p)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00206">ip.h:206</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_aa21d642e6874b9df89f9e404574d62a9"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a></div><div class="ttdeci">typedefPACK_STRUCT_END struct ip_addr ip_addr_t</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00064">ip_addr.h:64</a></div></div>
<div class="ttc" id="structnetif_html_a9776aaee37ea8f07b9ddc0f8b4e7e866"><div class="ttname"><a href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">netif::ip_addr</a></div><div class="ttdeci">ip_addr_t ip_addr</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00144">netif.h:144</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a0d51c2bb5f2af51392540af1c5df511a"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a0d51c2bb5f2af51392540af1c5df511a">ip_addr_isany</a></div><div class="ttdeci">#define ip_addr_isany(addr1)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00200">ip_addr.h:200</a></div></div>
<div class="ttc" id="structnetif_html_aca7d56b4e0f822b0ced2885f222b8d48"><div class="ttname"><a href="structnetif.html#aca7d56b4e0f822b0ced2885f222b8d48">netif::mtu</a></div><div class="ttdeci">u16_t mtu</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00187">netif.h:187</a></div></div>
<div class="ttc" id="ip_8h_html_aec30403fb98b013bd094688de55cdaef"><div class="ttname"><a href="ip_8h.html#aec30403fb98b013bd094688de55cdaef">IPH_CHKSUM_SET</a></div><div class="ttdeci">#define IPH_CHKSUM_SET(hdr, chksum)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00160">ip.h:160</a></div></div>
<div class="ttc" id="ip_8h_html_aa0e49f03bd4c3144e3548a0db72d1deb"><div class="ttname"><a href="ip_8h.html#aa0e49f03bd4c3144e3548a0db72d1deb">IPH_TTL_SET</a></div><div class="ttdeci">#define IPH_TTL_SET(hdr, ttl)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00158">ip.h:158</a></div></div>
<div class="ttc" id="structip__hdr_html"><div class="ttname"><a href="structip__hdr.html">ip_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00116">ip.h:116</a></div></div>
<div class="ttc" id="ip_8h_html_ad76777d4d34f33ab5f715f9ca15503c3"><div class="ttname"><a href="ip_8h.html#ad76777d4d34f33ab5f715f9ca15503c3">IP_HLEN</a></div><div class="ttdeci">#define IP_HLEN</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00050">ip.h:50</a></div></div>
<div class="ttc" id="pbuf_8h_html_a2e8fb29db85437c62b7dfc80e8257deb"><div class="ttname"><a href="pbuf_8h.html#a2e8fb29db85437c62b7dfc80e8257deb">pbuf_header</a></div><div class="ttdeci">u8_t pbuf_header(struct pbuf *p, s16_t header_size) ICACHE_FLASH_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8c_source.html#l00573">pbuf.c:573</a></div></div>
<div class="ttc" id="cc_8h_html_ae081489b4906f65a3cb18e9fbe9f8d23"><div class="ttname"><a href="cc_8h.html#ae081489b4906f65a3cb18e9fbe9f8d23">u8_t</a></div><div class="ttdeci">unsigned char u8_t</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00052">cc.h:52</a></div></div>
<div class="ttc" id="opt_8h_html_aa1dd57a66b6de8c0593e9e3e8d1411f6"><div class="ttname"><a href="opt_8h.html#aa1dd57a66b6de8c0593e9e3e8d1411f6">MEMCPY</a></div><div class="ttdeci">#define MEMCPY(dst, src, len)</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l00084">opt.h:84</a></div></div>
<div class="ttc" id="ip_8h_html_a3b2c57b6a9dc9cc32fc2f145a96bbf8f"><div class="ttname"><a href="ip_8h.html#a3b2c57b6a9dc9cc32fc2f145a96bbf8f">IPH_ID_SET</a></div><div class="ttdeci">#define IPH_ID_SET(hdr, id)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00156">ip.h:156</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a94ad086267808462beae2b38f91996ed"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a94ad086267808462beae2b38f91996ed">LWIP_ASSERT</a></div><div class="ttdeci">#define LWIP_ASSERT(message, assertion)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00066">debug.h:66</a></div></div>
<div class="ttc" id="structpbuf_html_a8d32dc3e964369d4eec638fc37fbc460"><div class="ttname"><a href="structpbuf.html#a8d32dc3e964369d4eec638fc37fbc460">pbuf::payload</a></div><div class="ttdeci">void * payload</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00081">pbuf.h:81</a></div></div>
<div class="ttc" id="stats_8h_html_af0a2079f449ce75c1eb49b8a5c922de8"><div class="ttname"><a href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a></div><div class="ttdeci">#define IP_STATS_INC(x)</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00203">stats.h:203</a></div></div>
<div class="ttc" id="structnetif_html_a32fca6ffd28bb9af3f891a378827a67e"><div class="ttname"><a href="structnetif.html#a32fca6ffd28bb9af3f891a378827a67e">netif::name</a></div><div class="ttdeci">char name[2]</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00195">netif.h:195</a></div></div>
<div class="ttc" id="ip_8h_html_a069cb9b3765c4bdd63d13efb2df0206e"><div class="ttname"><a href="ip_8h.html#a069cb9b3765c4bdd63d13efb2df0206e">IPH_LEN_SET</a></div><div class="ttdeci">#define IPH_LEN_SET(hdr, len)</div><div class="ttdef"><b>Definition:</b> <a href="ip_8h_source.html#l00155">ip.h:155</a></div></div>
<div class="ttc" id="structpbuf_html_a18e2c02942feb1baa3756fcd585b6731"><div class="ttname"><a href="structpbuf.html#a18e2c02942feb1baa3756fcd585b6731">pbuf::ref</a></div><div class="ttdeci">u16_t ref</div><div class="ttdef"><b>Definition:</b> <a href="pbuf_8h_source.html#l00106">pbuf.h:106</a></div></div>
<div class="ttc" id="def_8h_html_a50bb84f05471465a5cb441421274954d"><div class="ttname"><a href="def_8h.html#a50bb84f05471465a5cb441421274954d">LWIP_MAKE_U16</a></div><div class="ttdeci">#define LWIP_MAKE_U16(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00056">def.h:56</a></div></div>
<div class="ttc" id="snmp_8h_html_a50ec8161ad8d406d8bbfba5991c97e98"><div class="ttname"><a href="snmp_8h.html#a50ec8161ad8d406d8bbfba5991c97e98">snmp_inc_ipoutrequests</a></div><div class="ttdeci">#define snmp_inc_ipoutrequests()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00268">snmp.h:268</a></div></div>
<div class="ttc" id="cc_8h_html_afc6499c1f28697aa3bfc2804d496fd11"><div class="ttname"><a href="cc_8h.html#afc6499c1f28697aa3bfc2804d496fd11">u16_t</a></div><div class="ttdeci">unsigned short u16_t</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00054">cc.h:54</a></div></div>
<div class="ttc" id="err_8h_html_ae1dcf352601ec4d3b700910df24f863d"><div class="ttname"><a href="err_8h.html#ae1dcf352601ec4d3b700910df24f863d">ERR_BUF</a></div><div class="ttdeci">#define ERR_BUF</div><div class="ttdef"><b>Definition:</b> <a href="err_8h_source.html#l00054">err.h:54</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h_a0e401f7437b993011d343f78f6647a76_cgraph.svg" width="407" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h_a0e401f7437b993011d343f78f6647a76_icgraph.svg" width="223" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a134eb96f764190bd45f97284d1bf3c4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a134eb96f764190bd45f97284d1bf3c4f">&#9670;&nbsp;</a></span>ip_route()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structnetif.html">netif</a>* ip_route </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finds the appropriate network interface for a given IP address. It searches the list of network interfaces linearly. A match is found if the masked IP address of the network interface equals the masked IP address given to the function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dest</td><td>the destination IP address for which to find the route </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the netif on which to send to reach dest </dd></dl>

<p class="definition">Definition at line <a class="el" href="ip_8c_source.html#l00177">177</a> of file <a class="el" href="ip_8c_source.html">ip.c</a>.</p>

<p class="reference">References <a class="el" href="wlan__lwip__if_8h.html#a7e70d2ab3f2caed091644850737a363e">eagle_lwip_getif()</a>, <a class="el" href="ip__route_8h_source.html#l00016">route_entry::gw</a>, <a class="el" href="c__types_8h_source.html#l00101">ICACHE_FLASH_ATTR</a>, <a class="el" href="ip__route_8h_source.html#l00014">route_entry::ip</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00226">ip4_addr1_16</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00227">ip4_addr2_16</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00228">ip4_addr3_16</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00229">ip4_addr4_16</a>, <a class="el" href="netif_8h_source.html#l00144">netif::ip_addr</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00162">ip_addr_copy</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00202">ip_addr_isbroadcast</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00194">ip_addr_netcmp</a>, <a class="el" href="opt_8h_source.html#l01883">IP_DEBUG</a>, <a class="el" href="ip__route_8h.html#a9e642b6d90d9684da54de297207bc501">ip_find_route()</a>, <a class="el" href="stats_8h_source.html#l00203">IP_STATS_INC</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00047">LWIP_DBG_LEVEL_SERIOUS</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">LWIP_DEBUGF</a>, <a class="el" href="netif_8c_source.html#l00076">netif_default</a>, <a class="el" href="netif_8h_source.html#l00286">netif_is_up</a>, <a class="el" href="netif_8c_source.html#l00075">netif_list</a>, <a class="el" href="netif_8h_source.html#l00145">netif::netmask</a>, <a class="el" href="netif_8h_source.html#l00141">netif::next</a>, <a class="el" href="def_8h_source.html#l00047">NULL</a>, <a class="el" href="snmp_8h_source.html#l00270">snmp_inc_ipoutnoroutes</a>, and <a class="el" href="cc_8h_source.html#l00061">U16_F</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01592">ip_output()</a>, <a class="el" href="ip_8c_source.html#l01406">ip_output_if()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keyword">struct </span><a class="code" href="structnetif.html">netif</a> *<a class="code" href="structnetif.html">netif</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#ifdef IP_ROUTING_TAB</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a>(current_ip_new_dest, *dest);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">#ifdef IP_ROUTING_TAB</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">//os_printf_plus(&quot;ip_route route to %d.%d.%d.%d\r\n&quot;,</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">//          ip4_addr1_16(dest), ip4_addr2_16(dest), ip4_addr3_16(dest), ip4_addr4_16(dest));</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">/* search route */</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keyword">struct </span><a class="code" href="structroute__entry.html">route_entry</a> *found_route = <a class="code" href="ip__route_8h.html#a9e642b6d90d9684da54de297207bc501">ip_find_route</a>(*dest);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">if</span> (found_route) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a>(current_ip_new_dest, found_route-&gt;<a class="code" href="structroute__entry.html#a5218e916b639e81fdc002fd2c488765a">gw</a>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">/* now go on and find the netif on which to forward the packet */</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    dest = &amp;current_ip_new_dest;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">//os_printf_plus(&quot;redirected to %d.%d.%d.%d\r\n&quot;,</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">//          ip4_addr1_16(dest), ip4_addr2_16(dest), ip4_addr3_16(dest), ip4_addr4_16(dest));</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* IP_ROUTING_TAB */</span><span class="preprocessor"></span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">/* iterate through netifs */</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">for</span>(netif = <a class="code" href="netif_8h.html#a1c8141eaa98f6dc6dfddbb23a706656c">netif_list</a>; netif != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; netif = netif-&gt;<a class="code" href="structnetif.html#ae77736b64df442242795220d76be6b86">next</a>) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">/* network mask matches? */</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a>(netif)) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3a2123f0bbf6fe843c8542e349c680eb">ip_addr_netcmp</a>(dest, &amp;(netif-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>), &amp;(netif-&gt;<a class="code" href="structnetif.html#a5192f2fa2533f13cfde07d9d5bb0db2b">netmask</a>))) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">/* return netif on which to forward IP packet */</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">//os_printf_plus(&quot;send through netif %c%c%d\r\n&quot;, netif-&gt;name[0], netif-&gt;name[1], netif-&gt;num);</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">return</span> netif;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">/* iterate through netifs */</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">for</span>(netif = <a class="code" href="netif_8h.html#a1c8141eaa98f6dc6dfddbb23a706656c">netif_list</a>; netif != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; netif = netif-&gt;<a class="code" href="structnetif.html#ae77736b64df442242795220d76be6b86">next</a>) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">/* This is a hack! Always sends is through the STA interface as default */</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a>(netif)) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa3345706e3aa8b32dd630c195b053e75">ip_addr_isbroadcast</a>(dest, netif) &amp;&amp; netif == (<span class="keyword">struct</span> netif *)<a class="code" href="wlan__lwip__if_8h.html#a7e70d2ab3f2caed091644850737a363e">eagle_lwip_getif</a>(0)) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">//os_printf_plus(&quot;HACK send through netif %c%c%d\r\n&quot;, netif-&gt;name[0], netif-&gt;name[1], netif-&gt;num);</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">return</span> netif;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="netif_8h.html#a3d0925cbce550ed461907aee816713ba">netif_default</a> == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (!<a class="code" href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a>(<a class="code" href="netif_8h.html#a3d0925cbce550ed461907aee816713ba">netif_default</a>))) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>, (<span class="stringliteral">&quot;ip_route: No route to %&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;.%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;.%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;.%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a15d6d219310ffb5a225cdc13404072dc">ip4_addr1_16</a>(dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3d0584d6d81c59b05824d65b95fedb63">ip4_addr2_16</a>(dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aab3a41c7d715de7fa8de42600be7c189">ip4_addr3_16</a>(dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad063f9120ca605616531abe3e4860dc9">ip4_addr4_16</a>(dest)));</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(<a class="code" href="structroute__entry.html#ad98ba15ef6a5165c48cfa915b4bbf637">ip</a>.rterr);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="snmp_8h.html#a220c63ed6d2584fe662d6db98d4e9d5a">snmp_inc_ipoutnoroutes</a>();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">//os_printf_plus(&quot;no netif found\r\n&quot;);</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">/* no matching netif found, use default netif */</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">//os_printf_plus(&quot;send through netif %c%c%d\r\n&quot;, netif_default-&gt;name[0], netif_default-&gt;name[1], netif_default-&gt;num);</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="netif_8h.html#a3d0925cbce550ed461907aee816713ba">netif_default</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div><div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_aab3a41c7d715de7fa8de42600be7c189"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aab3a41c7d715de7fa8de42600be7c189">ip4_addr3_16</a></div><div class="ttdeci">#define ip4_addr3_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00228">ip_addr.h:228</a></div></div>
<div class="ttc" id="structroute__entry_html_ad98ba15ef6a5165c48cfa915b4bbf637"><div class="ttname"><a href="structroute__entry.html#ad98ba15ef6a5165c48cfa915b4bbf637">route_entry::ip</a></div><div class="ttdeci">ip_addr_t ip</div><div class="ttdef"><b>Definition:</b> <a href="ip__route_8h_source.html#l00014">ip_route.h:14</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a3a2123f0bbf6fe843c8542e349c680eb"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3a2123f0bbf6fe843c8542e349c680eb">ip_addr_netcmp</a></div><div class="ttdeci">#define ip_addr_netcmp(addr1, addr2, mask)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00194">ip_addr.h:194</a></div></div>
<div class="ttc" id="cc_8h_html_aa9d7f6eb2ee9fcc5eda3545dbb1886e0"><div class="ttname"><a href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a></div><div class="ttdeci">#define U16_F</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00061">cc.h:61</a></div></div>
<div class="ttc" id="netif_8h_html_a1c8141eaa98f6dc6dfddbb23a706656c"><div class="ttname"><a href="netif_8h.html#a1c8141eaa98f6dc6dfddbb23a706656c">netif_list</a></div><div class="ttdeci">struct netif * netif_list</div><div class="ttdef"><b>Definition:</b> <a href="netif_8c_source.html#l00075">netif.c:75</a></div></div>
<div class="ttc" id="def_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00047">def.h:47</a></div></div>
<div class="ttc" id="wlan__lwip__if_8h_html_a7e70d2ab3f2caed091644850737a363e"><div class="ttname"><a href="wlan__lwip__if_8h.html#a7e70d2ab3f2caed091644850737a363e">eagle_lwip_getif</a></div><div class="ttdeci">struct netif * eagle_lwip_getif(uint8 index)</div></div>
<div class="ttc" id="opt_8h_html_a5d3348778951e7bc5cd397c6575eef3a"><div class="ttname"><a href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a></div><div class="ttdeci">#define IP_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l01883">opt.h:1883</a></div></div>
<div class="ttc" id="snmp_8h_html_a220c63ed6d2584fe662d6db98d4e9d5a"><div class="ttname"><a href="snmp_8h.html#a220c63ed6d2584fe662d6db98d4e9d5a">snmp_inc_ipoutnoroutes</a></div><div class="ttdeci">#define snmp_inc_ipoutnoroutes()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00270">snmp.h:270</a></div></div>
<div class="ttc" id="ip__route_8h_html_a9e642b6d90d9684da54de297207bc501"><div class="ttname"><a href="ip__route_8h.html#a9e642b6d90d9684da54de297207bc501">ip_find_route</a></div><div class="ttdeci">struct route_entry * ip_find_route(ip_addr_t ip)</div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a63a04edf7ff63c951bd8706711956cdb"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a></div><div class="ttdeci">#define LWIP_DEBUGF(debug, message)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">debug.h:95</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a77a933975db287f6aa5c2e70249ba18f"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a77a933975db287f6aa5c2e70249ba18f">ip_addr_copy</a></div><div class="ttdeci">#define ip_addr_copy(dest, src)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00162">ip_addr.h:162</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a0269bdc51f1e8a5ecf9af72c6e1c996c"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a></div><div class="ttdeci">#define LWIP_DBG_LEVEL_SERIOUS</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00047">debug.h:47</a></div></div>
<div class="ttc" id="structnetif_html_ae77736b64df442242795220d76be6b86"><div class="ttname"><a href="structnetif.html#ae77736b64df442242795220d76be6b86">netif::next</a></div><div class="ttdeci">struct netif * next</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00141">netif.h:141</a></div></div>
<div class="ttc" id="netif_8h_html_a3d0925cbce550ed461907aee816713ba"><div class="ttname"><a href="netif_8h.html#a3d0925cbce550ed461907aee816713ba">netif_default</a></div><div class="ttdeci">struct netif * netif_default</div><div class="ttdef"><b>Definition:</b> <a href="netif_8c_source.html#l00076">netif.c:76</a></div></div>
<div class="ttc" id="structnetif_html"><div class="ttname"><a href="structnetif.html">netif</a></div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00139">netif.h:139</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_ad063f9120ca605616531abe3e4860dc9"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad063f9120ca605616531abe3e4860dc9">ip4_addr4_16</a></div><div class="ttdeci">#define ip4_addr4_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00229">ip_addr.h:229</a></div></div>
<div class="ttc" id="structnetif_html_a9776aaee37ea8f07b9ddc0f8b4e7e866"><div class="ttname"><a href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">netif::ip_addr</a></div><div class="ttdeci">ip_addr_t ip_addr</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00144">netif.h:144</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_aa3345706e3aa8b32dd630c195b053e75"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa3345706e3aa8b32dd630c195b053e75">ip_addr_isbroadcast</a></div><div class="ttdeci">#define ip_addr_isbroadcast(ipaddr, netif)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00202">ip_addr.h:202</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a15d6d219310ffb5a225cdc13404072dc"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a15d6d219310ffb5a225cdc13404072dc">ip4_addr1_16</a></div><div class="ttdeci">#define ip4_addr1_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00226">ip_addr.h:226</a></div></div>
<div class="ttc" id="stats_8h_html_af0a2079f449ce75c1eb49b8a5c922de8"><div class="ttname"><a href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a></div><div class="ttdeci">#define IP_STATS_INC(x)</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00203">stats.h:203</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a3d0584d6d81c59b05824d65b95fedb63"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3d0584d6d81c59b05824d65b95fedb63">ip4_addr2_16</a></div><div class="ttdeci">#define ip4_addr2_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00227">ip_addr.h:227</a></div></div>
<div class="ttc" id="structnetif_html_a5192f2fa2533f13cfde07d9d5bb0db2b"><div class="ttname"><a href="structnetif.html#a5192f2fa2533f13cfde07d9d5bb0db2b">netif::netmask</a></div><div class="ttdeci">ip_addr_t netmask</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00145">netif.h:145</a></div></div>
<div class="ttc" id="netif_8h_html_a94a4c24c988afc0a577387730f303b19"><div class="ttname"><a href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a></div><div class="ttdeci">#define netif_is_up(netif)</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00286">netif.h:286</a></div></div>
<div class="ttc" id="structroute__entry_html"><div class="ttname"><a href="structroute__entry.html">route_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="ip__route_8h_source.html#l00013">ip_route.h:13</a></div></div>
<div class="ttc" id="structroute__entry_html_a5218e916b639e81fdc002fd2c488765a"><div class="ttname"><a href="structroute__entry.html#a5218e916b639e81fdc002fd2c488765a">route_entry::gw</a></div><div class="ttdeci">ip_addr_t gw</div><div class="ttdef"><b>Definition:</b> <a href="ip__route_8h_source.html#l00016">ip_route.h:16</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h_a134eb96f764190bd45f97284d1bf3c4f_cgraph.svg" width="242" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h_a134eb96f764190bd45f97284d1bf3c4f_icgraph.svg" width="339" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a195d1813b8e5468028079f9518973c19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a195d1813b8e5468028079f9518973c19">&#9670;&nbsp;</a></span>ip_router()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structnetif.html">netif</a>* ip_router </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> *&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finds the appropriate network interface for a source IP address. It searches the list of network interfaces linearly. A match is found if the masked IP address of the network interface equals the masked IP address given to the function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source</td><td>the sourcination IP address for which to find the route </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the netif on which to send to reach source </dd></dl>

<p class="definition">Definition at line <a class="el" href="ip_8c_source.html#l00248">248</a> of file <a class="el" href="ip_8c_source.html">ip.c</a>.</p>

<p class="reference">References <a class="el" href="ip_8c_source.html#l00113">current_iphdr_dest</a>, <a class="el" href="err_8h_source.html#l00052">ERR_OK</a>, <a class="el" href="err_8h_source.html#l00056">ERR_RTE</a>, <a class="el" href="c__types_8h_source.html#l00101">ICACHE_FLASH_ATTR</a>, <a class="el" href="icmp_8h_source.html#l00060">ICMP_DUR_PORT</a>, <a class="el" href="icmp_8h_source.html#l00048">ICMP_ECHO</a>, <a class="el" href="icmp_8h_source.html#l00044">ICMP_ER</a>, <a class="el" href="icmp_8h_source.html#l00066">ICMP_TE_TTL</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00226">ip4_addr1_16</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00227">ip4_addr2_16</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00228">ip4_addr3_16</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00229">ip4_addr4_16</a>, <a class="el" href="netif_8h_source.html#l00144">netif::ip_addr</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00198">ip_addr_cmp</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00162">ip_addr_copy</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00200">ip_addr_isany</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00210">ip_addr_islinklocal</a>, <a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00194">ip_addr_netcmp</a>, <a class="el" href="opt_8h_source.html#l01883">IP_DEBUG</a>, <a class="el" href="ip_8h_source.html#l00052">IP_PROTO_ICMP</a>, <a class="el" href="ip_8h_source.html#l00056">IP_PROTO_TCP</a>, <a class="el" href="ip_8h_source.html#l00054">IP_PROTO_UDP</a>, <a class="el" href="ip_8c_source.html#l00177">ip_route()</a>, <a class="el" href="opt_8h_source.html#l00508">IP_ROUTING_TAB</a>, <a class="el" href="stats_8h_source.html#l00203">IP_STATS_INC</a>, <a class="el" href="ip_8h_source.html#l00152">IPH_CHKSUM</a>, <a class="el" href="ip_8h_source.html#l00160">IPH_CHKSUM_SET</a>, <a class="el" href="ip_8h_source.html#l00145">IPH_HL</a>, <a class="el" href="ip_8h_source.html#l00151">IPH_PROTO</a>, <a class="el" href="ip_8h_source.html#l00150">IPH_TTL</a>, <a class="el" href="ip_8h_source.html#l00158">IPH_TTL_SET</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00047">LWIP_DBG_LEVEL_SERIOUS</a>, <a class="el" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">LWIP_DEBUGF</a>, <a class="el" href="sys_8h_source.html#l00242">LWIP_TIME_DIFF</a>, <a class="el" href="platform_8h_source.html#l00022">memcpy</a>, <a class="el" href="netif_8h_source.html#l00187">netif::mtu</a>, <a class="el" href="opt_8h_source.html#l02059">NAPT_DEBUG</a>, <a class="el" href="ip_8h_source.html#l00212">napt_debug_print</a>, <a class="el" href="netif_8c_source.html#l00076">netif_default</a>, <a class="el" href="netif_8h_source.html#l00286">netif_is_up</a>, <a class="el" href="netif_8c_source.html#l00075">netif_list</a>, <a class="el" href="netif_8h_source.html#l00145">netif::netmask</a>, <a class="el" href="netif_8h_source.html#l00141">netif::next</a>, <a class="el" href="def_8h_source.html#l00047">NULL</a>, <a class="el" href="netif_8h_source.html#l00197">netif::num</a>, <a class="el" href="osapi_8h_source.html#l00092">os_printf</a>, <a class="el" href="osapi_8h.html#a843dbb5381392162286905a08a14888e">os_random()</a>, <a class="el" href="sdk_2include_2mem_8h_source.html#l00119">os_zalloc</a>, <a class="el" href="netif_8h_source.html#l00154">netif::output</a>, <a class="el" href="pbuf_8h_source.html#l00081">pbuf::payload</a>, <a class="el" href="perf_8h_source.html#l00037">PERF_START</a>, <a class="el" href="perf_8h_source.html#l00038">PERF_STOP</a>, <a class="el" href="def_8h_source.html#l00092">PP_HTONS</a>, <a class="el" href="def_8h_source.html#l00093">PP_NTOHS</a>, <a class="el" href="snmp_8h_source.html#l00264">snmp_inc_ipforwdatagrams</a>, <a class="el" href="snmp_8h_source.html#l00262">snmp_inc_ipinhdrerrors</a>, <a class="el" href="snmp_8h_source.html#l00270">snmp_inc_ipoutnoroutes</a>, <a class="el" href="sys_8h_source.html#l00235">sys_now()</a>, and <a class="el" href="cc_8h_source.html#l00061">U16_F</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                             {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnetif.html">netif</a> *<a class="code" href="structnetif.html">netif</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">/* iterate through netifs */</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">for</span>(netif = <a class="code" href="netif_8h.html#a1c8141eaa98f6dc6dfddbb23a706656c">netif_list</a>; netif != <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; netif = netif-&gt;<a class="code" href="structnetif.html#ae77736b64df442242795220d76be6b86">next</a>) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">/* network mask matches? */</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a>(netif)) {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3a2123f0bbf6fe843c8542e349c680eb">ip_addr_netcmp</a>(dest, &amp;(netif-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>), &amp;(netif-&gt;<a class="code" href="structnetif.html#a5192f2fa2533f13cfde07d9d5bb0db2b">netmask</a>))) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="comment">/* return netif on which to forward IP packet */</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">return</span> netif;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a>(netif)) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3a2123f0bbf6fe843c8542e349c680eb">ip_addr_netcmp</a>(source, &amp;(netif-&gt;<a class="code" href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">ip_addr</a>), &amp;(netif-&gt;<a class="code" href="structnetif.html#a5192f2fa2533f13cfde07d9d5bb0db2b">netmask</a>))) {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">/* return netif on which to forward IP packet */</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">return</span> netif;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;          }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="netif_8h.html#a3d0925cbce550ed461907aee816713ba">netif_default</a> == <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (!<a class="code" href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a>(<a class="code" href="netif_8h.html#a3d0925cbce550ed461907aee816713ba">netif_default</a>))) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a>(<a class="code" href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a> | <a class="code" href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a>, (<span class="stringliteral">&quot;ip_route: No route to %&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;.%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;.%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;.%&quot;</span><a class="code" href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a><span class="stringliteral">&quot;\n&quot;</span>,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a15d6d219310ffb5a225cdc13404072dc">ip4_addr1_16</a>(dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3d0584d6d81c59b05824d65b95fedb63">ip4_addr2_16</a>(dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aab3a41c7d715de7fa8de42600be7c189">ip4_addr3_16</a>(dest), <a class="code" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad063f9120ca605616531abe3e4860dc9">ip4_addr4_16</a>(dest)));</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a>(ip.rterr);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <a class="code" href="snmp_8h.html#a220c63ed6d2584fe662d6db98d4e9d5a">snmp_inc_ipoutnoroutes</a>();</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">/* no matching netif found, use default netif */</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="osapi_8h.html#a751d204d0c7e166a527475d79e803454">os_printf</a>(<span class="stringliteral">&quot;ip_router %d %p\n&quot;</span>, __LINE__, <a class="code" href="netif_8h.html#a3d0925cbce550ed461907aee816713ba">netif_default</a>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="netif_8h.html#a3d0925cbce550ed461907aee816713ba">netif_default</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div><div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_aab3a41c7d715de7fa8de42600be7c189"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aab3a41c7d715de7fa8de42600be7c189">ip4_addr3_16</a></div><div class="ttdeci">#define ip4_addr3_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00228">ip_addr.h:228</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a3a2123f0bbf6fe843c8542e349c680eb"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3a2123f0bbf6fe843c8542e349c680eb">ip_addr_netcmp</a></div><div class="ttdeci">#define ip_addr_netcmp(addr1, addr2, mask)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00194">ip_addr.h:194</a></div></div>
<div class="ttc" id="cc_8h_html_aa9d7f6eb2ee9fcc5eda3545dbb1886e0"><div class="ttname"><a href="cc_8h.html#aa9d7f6eb2ee9fcc5eda3545dbb1886e0">U16_F</a></div><div class="ttdeci">#define U16_F</div><div class="ttdef"><b>Definition:</b> <a href="cc_8h_source.html#l00061">cc.h:61</a></div></div>
<div class="ttc" id="netif_8h_html_a1c8141eaa98f6dc6dfddbb23a706656c"><div class="ttname"><a href="netif_8h.html#a1c8141eaa98f6dc6dfddbb23a706656c">netif_list</a></div><div class="ttdeci">struct netif * netif_list</div><div class="ttdef"><b>Definition:</b> <a href="netif_8c_source.html#l00075">netif.c:75</a></div></div>
<div class="ttc" id="def_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="def_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="def_8h_source.html#l00047">def.h:47</a></div></div>
<div class="ttc" id="opt_8h_html_a5d3348778951e7bc5cd397c6575eef3a"><div class="ttname"><a href="opt_8h.html#a5d3348778951e7bc5cd397c6575eef3a">IP_DEBUG</a></div><div class="ttdeci">#define IP_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="opt_8h_source.html#l01883">opt.h:1883</a></div></div>
<div class="ttc" id="osapi_8h_html_a751d204d0c7e166a527475d79e803454"><div class="ttname"><a href="osapi_8h.html#a751d204d0c7e166a527475d79e803454">os_printf</a></div><div class="ttdeci">#define os_printf</div><div class="ttdef"><b>Definition:</b> <a href="osapi_8h_source.html#l00092">osapi.h:92</a></div></div>
<div class="ttc" id="snmp_8h_html_a220c63ed6d2584fe662d6db98d4e9d5a"><div class="ttname"><a href="snmp_8h.html#a220c63ed6d2584fe662d6db98d4e9d5a">snmp_inc_ipoutnoroutes</a></div><div class="ttdeci">#define snmp_inc_ipoutnoroutes()</div><div class="ttdef"><b>Definition:</b> <a href="snmp_8h_source.html#l00270">snmp.h:270</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a63a04edf7ff63c951bd8706711956cdb"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a63a04edf7ff63c951bd8706711956cdb">LWIP_DEBUGF</a></div><div class="ttdeci">#define LWIP_DEBUGF(debug, message)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00095">debug.h:95</a></div></div>
<div class="ttc" id="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_html_a0269bdc51f1e8a5ecf9af72c6e1c996c"><div class="ttname"><a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h.html#a0269bdc51f1e8a5ecf9af72c6e1c996c">LWIP_DBG_LEVEL_SERIOUS</a></div><div class="ttdeci">#define LWIP_DBG_LEVEL_SERIOUS</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-sdk_2esp-open-lwip_2include_2lwip_2debug_8h_source.html#l00047">debug.h:47</a></div></div>
<div class="ttc" id="structnetif_html_ae77736b64df442242795220d76be6b86"><div class="ttname"><a href="structnetif.html#ae77736b64df442242795220d76be6b86">netif::next</a></div><div class="ttdeci">struct netif * next</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00141">netif.h:141</a></div></div>
<div class="ttc" id="netif_8h_html_a3d0925cbce550ed461907aee816713ba"><div class="ttname"><a href="netif_8h.html#a3d0925cbce550ed461907aee816713ba">netif_default</a></div><div class="ttdeci">struct netif * netif_default</div><div class="ttdef"><b>Definition:</b> <a href="netif_8c_source.html#l00076">netif.c:76</a></div></div>
<div class="ttc" id="structnetif_html"><div class="ttname"><a href="structnetif.html">netif</a></div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00139">netif.h:139</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_ad063f9120ca605616531abe3e4860dc9"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#ad063f9120ca605616531abe3e4860dc9">ip4_addr4_16</a></div><div class="ttdeci">#define ip4_addr4_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00229">ip_addr.h:229</a></div></div>
<div class="ttc" id="structnetif_html_a9776aaee37ea8f07b9ddc0f8b4e7e866"><div class="ttname"><a href="structnetif.html#a9776aaee37ea8f07b9ddc0f8b4e7e866">netif::ip_addr</a></div><div class="ttdeci">ip_addr_t ip_addr</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00144">netif.h:144</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a15d6d219310ffb5a225cdc13404072dc"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a15d6d219310ffb5a225cdc13404072dc">ip4_addr1_16</a></div><div class="ttdeci">#define ip4_addr1_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00226">ip_addr.h:226</a></div></div>
<div class="ttc" id="stats_8h_html_af0a2079f449ce75c1eb49b8a5c922de8"><div class="ttname"><a href="stats_8h.html#af0a2079f449ce75c1eb49b8a5c922de8">IP_STATS_INC</a></div><div class="ttdeci">#define IP_STATS_INC(x)</div><div class="ttdef"><b>Definition:</b> <a href="stats_8h_source.html#l00203">stats.h:203</a></div></div>
<div class="ttc" id="esp-open-lwip_2include_2lwip_2ip__addr_8h_html_a3d0584d6d81c59b05824d65b95fedb63"><div class="ttname"><a href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#a3d0584d6d81c59b05824d65b95fedb63">ip4_addr2_16</a></div><div class="ttdeci">#define ip4_addr2_16(ipaddr)</div><div class="ttdef"><b>Definition:</b> <a href="esp-open-lwip_2include_2lwip_2ip__addr_8h_source.html#l00227">ip_addr.h:227</a></div></div>
<div class="ttc" id="structnetif_html_a5192f2fa2533f13cfde07d9d5bb0db2b"><div class="ttname"><a href="structnetif.html#a5192f2fa2533f13cfde07d9d5bb0db2b">netif::netmask</a></div><div class="ttdeci">ip_addr_t netmask</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00145">netif.h:145</a></div></div>
<div class="ttc" id="netif_8h_html_a94a4c24c988afc0a577387730f303b19"><div class="ttname"><a href="netif_8h.html#a94a4c24c988afc0a577387730f303b19">netif_is_up</a></div><div class="ttdeci">#define netif_is_up(netif)</div><div class="ttdef"><b>Definition:</b> <a href="netif_8h_source.html#l00286">netif.h:286</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ip_8h_a195d1813b8e5468028079f9518973c19_cgraph.svg" width="380" height="164"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a169cfb7f1ed23bc514e3e567644291af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a169cfb7f1ed23bc514e3e567644291af">&#9670;&nbsp;</a></span>current_header</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="structip__hdr.html">ip_hdr</a>* current_header</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Header of the input packet currently being processed. </p>

<p class="definition">Definition at line <a class="el" href="ip_8c_source.html#l00109">109</a> of file <a class="el" href="ip_8c_source.html">ip.c</a>.</p>

</div>
</div>
<a id="a63c0914cf407e33af9b47061bd6ae40d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63c0914cf407e33af9b47061bd6ae40d">&#9670;&nbsp;</a></span>current_iphdr_dest</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> current_iphdr_dest</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destination IP address of current_header </p>

<p class="definition">Definition at line <a class="el" href="ip_8c_source.html#l00113">113</a> of file <a class="el" href="ip_8c_source.html">ip.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>, and <a class="el" href="ip_8c_source.html#l00248">ip_router()</a>.</p>

</div>
</div>
<a id="a312380e254b06dd3041065a3ec27264b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a312380e254b06dd3041065a3ec27264b">&#9670;&nbsp;</a></span>current_iphdr_src</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="esp-open-lwip_2include_2lwip_2ip__addr_8h.html#aa21d642e6874b9df89f9e404574d62a9">ip_addr_t</a> current_iphdr_src</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Source IP address of current_header </p>

<p class="definition">Definition at line <a class="el" href="ip_8c_source.html#l00111">111</a> of file <a class="el" href="ip_8c_source.html">ip.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ip_8c_source.html#l01071">ip_input()</a>.</p>

</div>
</div>
<a id="aabce496c19c6ae4000174c8af8a4a913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabce496c19c6ae4000174c8af8a4a913">&#9670;&nbsp;</a></span>current_netif</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structnetif.html">netif</a>* current_netif</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The interface that provided the packet for the current callback invocation. </p>

<p class="definition">Definition at line <a class="el" href="ip_8c_source.html#l00104">104</a> of file <a class="el" href="ip_8c_source.html">ip.c</a>.</p>

</div>
</div>
<a id="a7082e3ecbecbf496df63fda29a1e0f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7082e3ecbecbf496df63fda29a1e0f06">&#9670;&nbsp;</a></span>PACK_STRUCT_STRUCT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arch_8h.html#a73199061891adf1b912d20835c7d5e96">PACK_STRUCT_BEGIN</a> struct <a class="el" href="structip__hdr.html">ip_hdr</a>  PACK_STRUCT_STRUCT</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
